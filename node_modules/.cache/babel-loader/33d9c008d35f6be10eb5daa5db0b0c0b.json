{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDom from 'react-dom';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { objectEqual } from './util';\nimport Tween from './Tween';\nimport ticker from './ticker';\n\nfunction noop() {}\n\nvar perFrame = Math.round(1000 / 60);\nvar objectOrArray = PropTypes.oneOfType([PropTypes.object, PropTypes.array]);\n\nvar TweenOne = function (_Component) {\n  _inherits(TweenOne, _Component);\n\n  _createClass(TweenOne, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, _ref) {\n      var prevProps = _ref.prevProps,\n          $self = _ref.$self;\n      var nextState = {\n        prevProps: props\n      };\n\n      if (prevProps && props !== prevProps) {\n        if (!$self.tween && !$self.dom) {\n          $self.updateAnim = true;\n          return nextState;\n        } // 动画处理\n\n\n        var newAnimation = props.animation;\n        var currentAnimation = prevProps.animation;\n        var equal = objectEqual(currentAnimation, newAnimation);\n\n        if (!equal) {\n          if (props.resetStyle && $self.tween) {\n            $self.tween.resetDefaultStyle();\n          }\n\n          $self.updateAnim = true;\n        } // 跳帧事件 moment;\n\n\n        var nextMoment = props.moment;\n\n        if (typeof nextMoment === 'number' && nextMoment !== prevProps.moment) {\n          if ($self.tween && !$self.updateAnim) {\n            $self.startMoment = nextMoment;\n            $self.startTime = ticker.time;\n\n            if (props.paused) {\n              $self.raf();\n            }\n\n            if ($self.tween.progressTime >= $self.tween.totalTime) {\n              $self.play();\n            }\n          } else {\n            $self.updateAnim = true;\n          }\n        } // 暂停倒放\n\n\n        if ($self.paused !== props.paused || $self.reverse !== props.reverse) {\n          $self.paused = props.paused;\n          $self.reverse = props.reverse;\n\n          if ($self.paused) {\n            $self.cancelRequestAnimationFrame();\n          } else if ($self.reverse && props.reverseDelay) {\n            $self.cancelRequestAnimationFrame();\n            ticker.timeout($self.restart, props.reverseDelay);\n          } else {\n            // 在 form 状态下，暂停时拉 moment 时，start 有值恢复播放，在 delay 的时间没有处理。。\n            if ($self.tween) {\n              $self.tween.resetAnimData();\n              $self.tween.resetDefaultStyle();\n            }\n\n            if (!$self.updateAnim) {\n              $self.restart();\n            }\n          }\n        }\n\n        var styleEqual = objectEqual(prevProps.style, props.style);\n\n        if (!styleEqual) {\n          // 在动画时更改了 style, 作为更改开始数值。\n          if ($self.tween) {\n            $self.tween.reStart(props.style, prevProps.style, $self.tween.progressTime < $self.tween.totalTime);\n\n            if ($self.paused) {\n              $self.raf();\n            }\n          }\n        }\n\n        $self.setForcedJudg(props);\n      }\n\n      return nextState; // eslint-disable-line\n    }\n  }]);\n\n  function TweenOne(props) {\n    _classCallCheck(this, TweenOne);\n\n    var _this = _possibleConstructorReturn(this, (TweenOne.__proto__ || Object.getPrototypeOf(TweenOne)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.rafID = -1;\n    _this.paused = props.paused;\n    _this.reverse = props.reverse;\n    _this.updateAnim = false;\n    _this.repeatNum = 0; // 定义 ref 给外部使用；\n\n    _this.currentRef = null;\n    _this.forced = {};\n\n    _this.setForcedJudg(props);\n\n    _this.state = {\n      $self: _this\n    };\n    return _this;\n  }\n\n  _createClass(TweenOne, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.dom = ReactDom.findDOMNode(this);\n\n      if (this.dom && this.dom.nodeName !== '#text') {\n        this.start();\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      if (!this.dom) {\n        this.dom = ReactDom.findDOMNode(this);\n      } // 样式更新了后再执行动画；\n\n\n      if (this.updateAnim && this.dom && this.dom.nodeName !== '#text') {\n        if (this.tween) {\n          this.cancelRequestAnimationFrame();\n        }\n\n        this.start();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.cancelRequestAnimationFrame();\n    }\n    /**\n     * @method setForcedJudg\n     * @param props\n     * QueueAnim 套在组件下面后导至子级变化。\n     * <QueueAnim component={Menu} >\n     *   <SubMenu key=\"a\" title=\"导航\">\n     *     <Item />\n     *   </SubMenu>\n     * </QueueAnim>\n     * rc-Menu 里是以 isXXX 来判断是 rc-Menu 的子级;\n     * 如: 用 isSubMenu 来处理 hover 事件\n     * 地址: https://github.com/react-component/menu/blob/master/src/MenuMixin.js#L172\n     * 暂时方案: 在组件里添加判断用的值。\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          animation = _props.animation,\n          component = _props.component,\n          componentProps = _props.componentProps,\n          reverseDelay = _props.reverseDelay,\n          attr = _props.attr,\n          paused = _props.paused,\n          reverse = _props.reverse,\n          repeat = _props.repeat,\n          yoyo = _props.yoyo,\n          moment = _props.moment,\n          resetStyle = _props.resetStyle,\n          forcedJudg = _props.forcedJudg,\n          props = _objectWithoutProperties(_props, ['animation', 'component', 'componentProps', 'reverseDelay', 'attr', 'paused', 'reverse', 'repeat', 'yoyo', 'moment', 'resetStyle', 'forcedJudg']);\n\n      Object.keys(props.style || {}).forEach(function (p) {\n        if (p.match(/filter/i)) {\n          ['Webkit', 'Moz', 'Ms', 'ms'].forEach(function (prefix) {\n            props.style[prefix + 'Filter'] = props.style[p];\n          });\n        }\n      });\n\n      var refFunc = function refFunc(c) {\n        _this2.currentRef = c;\n      }; // component 为空时调用子级的。。\n\n\n      var className = props.className,\n          children = props.children;\n\n      if (!component && typeof children !== 'string') {\n        if (!children) {\n          return children;\n        }\n\n        var childrenProps = children.props;\n\n        var _ref2 = childrenProps || {},\n            childStyle = _ref2.style,\n            childClass = _ref2.className; // 合并 style 与 className。\n\n\n        var newStyle = _extends({}, childStyle, props.style);\n\n        var newClassName = className ? className + ' ' + childClass : childClass;\n        return React.cloneElement(children, {\n          style: newStyle,\n          ref: refFunc,\n          className: newClassName\n        });\n      }\n\n      return React.createElement(component, _extends({\n        ref: refFunc\n      }, props, componentProps));\n    }\n  }]);\n\n  return TweenOne;\n}(Component);\n\nTweenOne.propTypes = {\n  component: PropTypes.any,\n  componentProps: PropTypes.any,\n  animation: objectOrArray,\n  children: PropTypes.any,\n  style: PropTypes.object,\n  paused: PropTypes.bool,\n  reverse: PropTypes.bool,\n  reverseDelay: PropTypes.number,\n  yoyo: PropTypes.bool,\n  repeat: PropTypes.number,\n  moment: PropTypes.number,\n  attr: PropTypes.string,\n  onChange: PropTypes.func,\n  resetStyle: PropTypes.bool,\n  forcedJudg: PropTypes.object\n};\nTweenOne.defaultProps = {\n  component: 'div',\n  componentProps: {},\n  reverseDelay: 0,\n  repeat: 0,\n  attr: 'style',\n  onChange: noop\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.setForcedJudg = function (props) {\n    Object.keys(_this3.forced).forEach(function (key) {\n      delete _this3[key];\n      delete _this3.forced[key];\n    });\n\n    if (props.forcedJudg) {\n      Object.keys(props.forcedJudg).forEach(function (key) {\n        if (!_this3[key]) {\n          _this3[key] = props.forcedJudg[key];\n          _this3.forced[key] = 1;\n        }\n      });\n    }\n  };\n\n  this.setDefault = function (props) {\n    _this3.moment = props.moment || 0;\n    _this3.startMoment = props.moment || 0;\n    _this3.startTime = ticker.time;\n  };\n\n  this.restart = function () {\n    if (!_this3.tween) {\n      return;\n    }\n\n    _this3.startMoment = _this3.moment;\n    _this3.startTime = ticker.time;\n    _this3.tween.reverse = _this3.reverse;\n    _this3.tween.reverseStartTime = _this3.startMoment;\n\n    _this3.raf();\n\n    _this3.play();\n  };\n\n  this.start = function () {\n    _this3.updateAnim = false;\n    var props = _this3.props;\n\n    if (props.animation && Object.keys(props.animation).length) {\n      _this3.setDefault(props);\n\n      _this3.tween = new Tween(_this3.dom, props.animation, props.attr);\n      _this3.tween.reverse = _this3.reverse; // 预先注册 raf, 初始动画数值。\n\n      _this3.raf(); // 开始动画\n\n\n      _this3.play();\n    } else {\n      _this3.tween = null;\n    }\n  };\n\n  this.play = function () {\n    _this3.cancelRequestAnimationFrame();\n\n    if (_this3.paused) {\n      return;\n    }\n\n    _this3.rafID = ticker.add(_this3.raf);\n  };\n\n  this.frame = function () {\n    var yoyo = _this3.props.yoyo;\n    var repeat = _this3.props.repeat;\n    var totalTime = repeat === -1 ? Number.MAX_VALUE : _this3.tween.totalTime * (repeat + 1);\n    repeat = repeat >= 0 ? repeat : Number.MAX_VALUE;\n    var moment = ticker.time - _this3.startTime + _this3.startMoment;\n\n    if (_this3.reverse) {\n      moment = (_this3.startMoment || 0) - (ticker.time - _this3.startTime);\n    }\n\n    moment = moment > totalTime ? totalTime : moment;\n    moment = moment <= 0 ? 0 : moment;\n    var repeatNum = Math.floor(moment / _this3.tween.totalTime) || 0;\n    repeatNum = repeatNum > repeat ? repeat : repeatNum;\n    var tweenMoment = moment - _this3.tween.totalTime * repeatNum;\n    tweenMoment = tweenMoment < perFrame && !_this3.reverse && totalTime >= perFrame ? 0 : tweenMoment;\n\n    if (repeat && moment && moment - _this3.tween.totalTime * repeatNum < perFrame) {\n      // 在重置样式之前补 complete；\n      _this3.tween.frame(_this3.tween.totalTime * repeatNum);\n    }\n\n    if (moment < _this3.moment && !_this3.reverse || repeat !== 0 && repeatNum && repeatNum !== _this3.repeatNum) {\n      // 在 form 状态下，暂停时拉 moment 时，start 有值，，往返方向播放时，在 delay 的时间没有处理。。\n      // 与上面的处理一样，删除 start ，重新走一遍 start。。\n      _this3.tween.resetAnimData();\n\n      _this3.tween.resetDefaultStyle();\n    }\n\n    var yoyoReverse = yoyo && repeatNum % 2;\n\n    if (yoyoReverse) {\n      tweenMoment = _this3.tween.totalTime - tweenMoment;\n    }\n\n    _this3.tween.onChange = function (e) {\n      var cb = _extends({}, e, {\n        timelineMode: ''\n      });\n\n      if (_this3.moment === _this3.startMoment && !_this3.reverse && !e.index && e.mode === 'onStart' || _this3.reverse) {\n        cb.timelineMode = 'onTimelineStart';\n      } else if (moment >= totalTime && !_this3.reverse || !moment && _this3.reverse) {\n        cb.timelineMode = 'onTimelineComplete';\n      } else if (repeatNum !== _this3.timelineRepeatNum) {\n        cb.timelineMode = 'onTimelineRepeat';\n      } else {\n        cb.timelineMode = 'onTimelineUpdate';\n      }\n\n      _this3.timelineRepeatNum = repeatNum;\n\n      _this3.props.onChange(cb);\n    };\n\n    _this3.moment = moment;\n    _this3.repeatNum = repeatNum;\n\n    _this3.tween.frame(tweenMoment);\n  };\n\n  this.raf = function () {\n    var tween = _this3.tween;\n\n    _this3.frame();\n\n    if (tween !== _this3.tween) {\n      // 在 onComplete 时更换动画时，raf 没结束，所以需要强制退出，避逸两个时间的冲突。\n      return null;\n    }\n\n    var repeat = _this3.props.repeat;\n    var totalTime = repeat === -1 ? Number.MAX_VALUE : _this3.tween.totalTime * (repeat + 1);\n\n    if (_this3.moment >= totalTime && !_this3.reverse || _this3.paused || _this3.reverse && _this3.moment === 0) {\n      return _this3.cancelRequestAnimationFrame();\n    }\n\n    return null;\n  };\n\n  this.cancelRequestAnimationFrame = function () {\n    ticker.clear(_this3.rafID);\n    _this3.rafID = -1;\n  };\n};\n\nTweenOne.isTweenOne = true;\nexport default polyfill(TweenOne);","map":{"version":3,"sources":["/Users/manhsy/Developer/manhsy-portfolio/node_modules/rc-tween-one/es/TweenOne.js"],"names":["_extends","_objectWithoutProperties","_classCallCheck","_possibleConstructorReturn","_createClass","_inherits","React","Component","PropTypes","ReactDom","polyfill","objectEqual","Tween","ticker","noop","perFrame","Math","round","objectOrArray","oneOfType","object","array","TweenOne","_Component","key","value","getDerivedStateFromProps","props","_ref","prevProps","$self","nextState","tween","dom","updateAnim","newAnimation","animation","currentAnimation","equal","resetStyle","resetDefaultStyle","nextMoment","moment","startMoment","startTime","time","paused","raf","progressTime","totalTime","play","reverse","cancelRequestAnimationFrame","reverseDelay","timeout","restart","resetAnimData","styleEqual","style","reStart","setForcedJudg","_this","__proto__","Object","getPrototypeOf","call","_initialiseProps","rafID","repeatNum","currentRef","forced","state","componentDidMount","findDOMNode","nodeName","start","componentDidUpdate","componentWillUnmount","render","_this2","_props","component","componentProps","attr","repeat","yoyo","forcedJudg","keys","forEach","p","match","prefix","refFunc","c","className","children","childrenProps","_ref2","childStyle","childClass","newStyle","newClassName","cloneElement","ref","createElement","propTypes","any","bool","number","string","onChange","func","defaultProps","_this3","setDefault","reverseStartTime","length","add","frame","Number","MAX_VALUE","floor","tweenMoment","yoyoReverse","e","cb","timelineMode","index","mode","timelineRepeatNum","clear","isTweenOne"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDom from 'react-dom';\nimport { polyfill } from 'react-lifecycles-compat';\n\nimport { objectEqual } from './util';\nimport Tween from './Tween';\nimport ticker from './ticker';\n\nfunction noop() {}\n\nvar perFrame = Math.round(1000 / 60);\nvar objectOrArray = PropTypes.oneOfType([PropTypes.object, PropTypes.array]);\n\nvar TweenOne = function (_Component) {\n  _inherits(TweenOne, _Component);\n\n  _createClass(TweenOne, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, _ref) {\n      var prevProps = _ref.prevProps,\n          $self = _ref.$self;\n\n      var nextState = {\n        prevProps: props\n      };\n      if (prevProps && props !== prevProps) {\n        if (!$self.tween && !$self.dom) {\n          $self.updateAnim = true;\n          return nextState;\n        }\n\n        // 动画处理\n        var newAnimation = props.animation;\n        var currentAnimation = prevProps.animation;\n        var equal = objectEqual(currentAnimation, newAnimation);\n        if (!equal) {\n          if (props.resetStyle && $self.tween) {\n            $self.tween.resetDefaultStyle();\n          }\n          $self.updateAnim = true;\n        }\n\n        // 跳帧事件 moment;\n        var nextMoment = props.moment;\n        if (typeof nextMoment === 'number' && nextMoment !== prevProps.moment) {\n          if ($self.tween && !$self.updateAnim) {\n            $self.startMoment = nextMoment;\n            $self.startTime = ticker.time;\n            if (props.paused) {\n              $self.raf();\n            }\n            if ($self.tween.progressTime >= $self.tween.totalTime) {\n              $self.play();\n            }\n          } else {\n            $self.updateAnim = true;\n          }\n        }\n\n        // 暂停倒放\n        if ($self.paused !== props.paused || $self.reverse !== props.reverse) {\n          $self.paused = props.paused;\n          $self.reverse = props.reverse;\n          if ($self.paused) {\n            $self.cancelRequestAnimationFrame();\n          } else if ($self.reverse && props.reverseDelay) {\n            $self.cancelRequestAnimationFrame();\n            ticker.timeout($self.restart, props.reverseDelay);\n          } else {\n            // 在 form 状态下，暂停时拉 moment 时，start 有值恢复播放，在 delay 的时间没有处理。。\n            if ($self.tween) {\n              $self.tween.resetAnimData();\n              $self.tween.resetDefaultStyle();\n            }\n            if (!$self.updateAnim) {\n              $self.restart();\n            }\n          }\n        }\n\n        var styleEqual = objectEqual(prevProps.style, props.style);\n        if (!styleEqual) {\n          // 在动画时更改了 style, 作为更改开始数值。\n          if ($self.tween) {\n            $self.tween.reStart(props.style, prevProps.style, $self.tween.progressTime < $self.tween.totalTime);\n            if ($self.paused) {\n              $self.raf();\n            }\n          }\n        }\n        $self.setForcedJudg(props);\n      }\n      return nextState; // eslint-disable-line\n    }\n  }]);\n\n  function TweenOne(props) {\n    _classCallCheck(this, TweenOne);\n\n    var _this = _possibleConstructorReturn(this, (TweenOne.__proto__ || Object.getPrototypeOf(TweenOne)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.rafID = -1;\n    _this.paused = props.paused;\n    _this.reverse = props.reverse;\n    _this.updateAnim = false;\n    _this.repeatNum = 0;\n    // 定义 ref 给外部使用；\n    _this.currentRef = null;\n    _this.forced = {};\n    _this.setForcedJudg(props);\n    _this.state = {\n      $self: _this\n    };\n    return _this;\n  }\n\n  _createClass(TweenOne, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.dom = ReactDom.findDOMNode(this);\n      if (this.dom && this.dom.nodeName !== '#text') {\n        this.start();\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      if (!this.dom) {\n        this.dom = ReactDom.findDOMNode(this);\n      }\n      // 样式更新了后再执行动画；\n      if (this.updateAnim && this.dom && this.dom.nodeName !== '#text') {\n        if (this.tween) {\n          this.cancelRequestAnimationFrame();\n        }\n        this.start();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.cancelRequestAnimationFrame();\n    }\n\n    /**\n     * @method setForcedJudg\n     * @param props\n     * QueueAnim 套在组件下面后导至子级变化。\n     * <QueueAnim component={Menu} >\n     *   <SubMenu key=\"a\" title=\"导航\">\n     *     <Item />\n     *   </SubMenu>\n     * </QueueAnim>\n     * rc-Menu 里是以 isXXX 来判断是 rc-Menu 的子级;\n     * 如: 用 isSubMenu 来处理 hover 事件\n     * 地址: https://github.com/react-component/menu/blob/master/src/MenuMixin.js#L172\n     * 暂时方案: 在组件里添加判断用的值。\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          animation = _props.animation,\n          component = _props.component,\n          componentProps = _props.componentProps,\n          reverseDelay = _props.reverseDelay,\n          attr = _props.attr,\n          paused = _props.paused,\n          reverse = _props.reverse,\n          repeat = _props.repeat,\n          yoyo = _props.yoyo,\n          moment = _props.moment,\n          resetStyle = _props.resetStyle,\n          forcedJudg = _props.forcedJudg,\n          props = _objectWithoutProperties(_props, ['animation', 'component', 'componentProps', 'reverseDelay', 'attr', 'paused', 'reverse', 'repeat', 'yoyo', 'moment', 'resetStyle', 'forcedJudg']);\n\n      Object.keys(props.style || {}).forEach(function (p) {\n        if (p.match(/filter/i)) {\n          ['Webkit', 'Moz', 'Ms', 'ms'].forEach(function (prefix) {\n            props.style[prefix + 'Filter'] = props.style[p];\n          });\n        }\n      });\n      var refFunc = function refFunc(c) {\n        _this2.currentRef = c;\n      };\n      // component 为空时调用子级的。。\n      var className = props.className,\n          children = props.children;\n\n      if (!component && typeof children !== 'string') {\n        if (!children) {\n          return children;\n        }\n        var childrenProps = children.props;\n\n        var _ref2 = childrenProps || {},\n            childStyle = _ref2.style,\n            childClass = _ref2.className;\n        // 合并 style 与 className。\n\n\n        var newStyle = _extends({}, childStyle, props.style);\n        var newClassName = className ? className + ' ' + childClass : childClass;\n        return React.cloneElement(children, { style: newStyle, ref: refFunc, className: newClassName });\n      }\n      return React.createElement(component, _extends({\n        ref: refFunc\n      }, props, componentProps));\n    }\n  }]);\n\n  return TweenOne;\n}(Component);\n\nTweenOne.propTypes = {\n  component: PropTypes.any,\n  componentProps: PropTypes.any,\n  animation: objectOrArray,\n  children: PropTypes.any,\n  style: PropTypes.object,\n  paused: PropTypes.bool,\n  reverse: PropTypes.bool,\n  reverseDelay: PropTypes.number,\n  yoyo: PropTypes.bool,\n  repeat: PropTypes.number,\n  moment: PropTypes.number,\n  attr: PropTypes.string,\n  onChange: PropTypes.func,\n  resetStyle: PropTypes.bool,\n  forcedJudg: PropTypes.object\n};\nTweenOne.defaultProps = {\n  component: 'div',\n  componentProps: {},\n  reverseDelay: 0,\n  repeat: 0,\n  attr: 'style',\n  onChange: noop\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.setForcedJudg = function (props) {\n    Object.keys(_this3.forced).forEach(function (key) {\n      delete _this3[key];\n      delete _this3.forced[key];\n    });\n    if (props.forcedJudg) {\n      Object.keys(props.forcedJudg).forEach(function (key) {\n        if (!_this3[key]) {\n          _this3[key] = props.forcedJudg[key];\n          _this3.forced[key] = 1;\n        }\n      });\n    }\n  };\n\n  this.setDefault = function (props) {\n    _this3.moment = props.moment || 0;\n    _this3.startMoment = props.moment || 0;\n    _this3.startTime = ticker.time;\n  };\n\n  this.restart = function () {\n    if (!_this3.tween) {\n      return;\n    }\n    _this3.startMoment = _this3.moment;\n    _this3.startTime = ticker.time;\n    _this3.tween.reverse = _this3.reverse;\n    _this3.tween.reverseStartTime = _this3.startMoment;\n    _this3.raf();\n    _this3.play();\n  };\n\n  this.start = function () {\n    _this3.updateAnim = false;\n    var props = _this3.props;\n    if (props.animation && Object.keys(props.animation).length) {\n      _this3.setDefault(props);\n      _this3.tween = new Tween(_this3.dom, props.animation, props.attr);\n      _this3.tween.reverse = _this3.reverse;\n      // 预先注册 raf, 初始动画数值。\n      _this3.raf();\n      // 开始动画\n      _this3.play();\n    } else {\n      _this3.tween = null;\n    }\n  };\n\n  this.play = function () {\n    _this3.cancelRequestAnimationFrame();\n    if (_this3.paused) {\n      return;\n    }\n    _this3.rafID = ticker.add(_this3.raf);\n  };\n\n  this.frame = function () {\n    var yoyo = _this3.props.yoyo;\n    var repeat = _this3.props.repeat;\n\n    var totalTime = repeat === -1 ? Number.MAX_VALUE : _this3.tween.totalTime * (repeat + 1);\n    repeat = repeat >= 0 ? repeat : Number.MAX_VALUE;\n    var moment = ticker.time - _this3.startTime + _this3.startMoment;\n    if (_this3.reverse) {\n      moment = (_this3.startMoment || 0) - (ticker.time - _this3.startTime);\n    }\n    moment = moment > totalTime ? totalTime : moment;\n    moment = moment <= 0 ? 0 : moment;\n    var repeatNum = Math.floor(moment / _this3.tween.totalTime) || 0;\n    repeatNum = repeatNum > repeat ? repeat : repeatNum;\n    var tweenMoment = moment - _this3.tween.totalTime * repeatNum;\n    tweenMoment = tweenMoment < perFrame && !_this3.reverse && totalTime >= perFrame ? 0 : tweenMoment;\n    if (repeat && moment && moment - _this3.tween.totalTime * repeatNum < perFrame) {\n      // 在重置样式之前补 complete；\n      _this3.tween.frame(_this3.tween.totalTime * repeatNum);\n    }\n    if (moment < _this3.moment && !_this3.reverse || repeat !== 0 && repeatNum && repeatNum !== _this3.repeatNum) {\n      // 在 form 状态下，暂停时拉 moment 时，start 有值，，往返方向播放时，在 delay 的时间没有处理。。\n      // 与上面的处理一样，删除 start ，重新走一遍 start。。\n      _this3.tween.resetAnimData();\n      _this3.tween.resetDefaultStyle();\n    }\n    var yoyoReverse = yoyo && repeatNum % 2;\n    if (yoyoReverse) {\n      tweenMoment = _this3.tween.totalTime - tweenMoment;\n    }\n    _this3.tween.onChange = function (e) {\n      var cb = _extends({}, e, {\n        timelineMode: ''\n      });\n\n      if (_this3.moment === _this3.startMoment && !_this3.reverse && !e.index && e.mode === 'onStart' || _this3.reverse) {\n        cb.timelineMode = 'onTimelineStart';\n      } else if (moment >= totalTime && !_this3.reverse || !moment && _this3.reverse) {\n        cb.timelineMode = 'onTimelineComplete';\n      } else if (repeatNum !== _this3.timelineRepeatNum) {\n        cb.timelineMode = 'onTimelineRepeat';\n      } else {\n        cb.timelineMode = 'onTimelineUpdate';\n      }\n      _this3.timelineRepeatNum = repeatNum;\n      _this3.props.onChange(cb);\n    };\n    _this3.moment = moment;\n    _this3.repeatNum = repeatNum;\n    _this3.tween.frame(tweenMoment);\n  };\n\n  this.raf = function () {\n    var tween = _this3.tween;\n    _this3.frame();\n    if (tween !== _this3.tween) {\n      // 在 onComplete 时更换动画时，raf 没结束，所以需要强制退出，避逸两个时间的冲突。\n      return null;\n    }\n    var repeat = _this3.props.repeat;\n\n    var totalTime = repeat === -1 ? Number.MAX_VALUE : _this3.tween.totalTime * (repeat + 1);\n    if (_this3.moment >= totalTime && !_this3.reverse || _this3.paused || _this3.reverse && _this3.moment === 0) {\n      return _this3.cancelRequestAnimationFrame();\n    }\n    return null;\n  };\n\n  this.cancelRequestAnimationFrame = function () {\n    ticker.clear(_this3.rafID);\n    _this3.rafID = -1;\n  };\n};\n\nTweenOne.isTweenOne = true;\nexport default polyfill(TweenOne);"]},"metadata":{},"sourceType":"module"}