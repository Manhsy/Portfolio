{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\n/* eslint-disable func-names */\n\n/**\n * Created by jljsj on 16/1/27.\n */\n\nimport { getColor, parseColor, toFixed, stylesToCss, createMatrix, getGsapType, isTransform, checkStyleName, toCssLowerCase } from 'style-utils';\nimport easingTypes from './easing';\nimport _plugin from './plugins';\nimport StylePlugin from './plugin/StylePlugin';\nimport { startConvertToEndUnit, transformOrFilter, dataToArray } from './util.js';\nvar DEFAULT_EASING = 'easeInOutQuad';\nvar DEFAULT_DURATION = 450;\nvar DEFAULT_DELAY = 0;\n\nfunction noop() {}\n\n_plugin.push(StylePlugin); // 设置默认数据\n\n\nfunction defaultData(vars, now) {\n  var duration = vars.duration || vars.duration === 0 ? vars.duration : DEFAULT_DURATION;\n  return {\n    duration: vars.type === 'set' ? 0 : duration,\n    delay: vars.delay || DEFAULT_DELAY,\n    ease: typeof vars.ease === 'function' ? vars.ease : easingTypes[vars.ease || DEFAULT_EASING],\n    onUpdate: vars.onUpdate || noop,\n    onComplete: vars.onComplete || noop,\n    onStart: vars.onStart || noop,\n    onRepeat: vars.onRepeat || noop,\n    repeat: vars.repeat || 0,\n    repeatDelay: vars.repeatDelay || 0,\n    yoyo: vars.yoyo || false,\n    type: vars.type === 'from' ? 'from' : 'to',\n    initTime: now,\n    appearTo: typeof vars.appearTo === 'number' ? vars.appearTo : null,\n    perTime: 0,\n    currentRepeat: 0\n  };\n}\n\nvar Tween = function Tween(target, to, attr) {\n  var toData = dataToArray(to);\n  this.target = target;\n  this.attr = attr || 'style'; // 时间精度补齐；\n\n  this.accuracy = 0.00001; // 记录总时间;\n\n  this.totalTime = 0; // 记录当前时间;\n\n  this.progressTime = 0; // 记录时间轴数据;\n\n  this.defaultData = []; // 每个的开始数据；\n\n  this.start = {}; // 开始默认的数据；\n\n  this.startDefaultData = {}; // 动画过程\n\n  this.tween = {}; // toData;\n\n  this.data = toData; // 每帧的时间;\n\n  this.perFrame = Math.round(1000 / 60); // 注册，第一次进入执行注册\n\n  this.register = false; // svg元素\n\n  this.isSvg = this.target.ownerSVGElement; // 设置 style\n\n  var data = this.setAttrIsStyle(); // 设置默认动画数据;\n\n  this.setDefaultData(data);\n};\n\nvar p = Tween.prototype;\n\np.setAttrIsStyle = function () {\n  var _this = this;\n\n  var data = [];\n  var defaultParam = defaultData({}, 0);\n  this.data.forEach(function (d, i) {\n    var _d = _extends({}, d);\n\n    if (_this.attr === 'style') {\n      data[i] = {};\n      Object.keys(_d).forEach(function (key) {\n        if (key in defaultParam) {\n          data[i][key] = _d[key];\n          delete _d[key];\n        }\n      });\n      data[i].style = _d;\n      _this.startDefaultData.style = _this.target.getAttribute('style') || '';\n    } else if (_this.attr === 'attr') {\n      Object.keys(_d).forEach(function (key) {\n        if (key === 'style' && Array.isArray(d[key])) {\n          throw new Error('Style should be the object.');\n        }\n\n        if (key === 'bezier') {\n          _d.style = _extends({}, _d.style, {\n            bezier: _d[key]\n          });\n          delete _d[key];\n          _this.startDefaultData.style = _this.target.getAttribute('style') || '';\n        } else {\n          if (key in defaultParam) {\n            return;\n          }\n\n          _this.startDefaultData[key] = _this.getValue(key);\n        }\n      });\n      data[i] = _d;\n    }\n  });\n  return data;\n};\n\np.setDefaultData = function (_vars) {\n  var _this2 = this;\n\n  var now = 0;\n  var repeatMax = false;\n\n  var data = _vars.map(function (item) {\n    var appearToBool = typeof item.appearTo === 'number'; // 加上延时，在没有播放过时；\n\n    if (!appearToBool) {\n      now += item.delay || 0;\n    }\n\n    var appearToTime = (item.appearTo || 0) + (item.delay || 0); // 获取默认数据\n\n    var tweenData = defaultData(item, appearToBool ? appearToTime : now);\n    tweenData.vars = {};\n    Object.keys(item).forEach(function (_key) {\n      if (!(_key in tweenData)) {\n        var _data = item[_key];\n\n        if (_key in _plugin) {\n          tweenData.vars[_key] = new _plugin[_key](_this2.target, _data, tweenData.type);\n        } else if ((_key === 'd' || _key === 'points') && 'SVGMorph' in _plugin) {\n          tweenData.vars[_key] = new _plugin.SVGMorph(_this2.target, _data, _key);\n        } else if (_key.match(/color/i) || _key === 'stroke' || _key === 'fill') {\n          tweenData.vars[_key] = {\n            type: 'color',\n            vars: parseColor(_data)\n          };\n        } else if (typeof _data === 'number' || _data.split(/[,|\\s]/g).length <= 1) {\n          var vars = parseFloat(_data);\n\n          var unit = _data.toString().replace(/[^a-z|%]/g, '');\n\n          var count = _data.toString().replace(/[^+|=|-]/g, '');\n\n          tweenData.vars[_key] = {\n            unit: unit,\n            vars: vars,\n            count: count\n          };\n        }\n      }\n    });\n\n    if (tweenData.yoyo && !tweenData.repeat) {\n      console.warn('Warning: yoyo must be used together with repeat;'); // eslint-disable-line\n    }\n\n    if (tweenData.repeat === -1) {\n      repeatMax = true;\n    }\n\n    var repeat = tweenData.repeat === -1 ? 0 : tweenData.repeat;\n\n    if (appearToBool) {\n      // 如果有 appearTo 且这条时间比 now 大时，，总时间用这条；\n      var appearNow = item.appearTo + (item.delay || 0) + tweenData.duration * (repeat + 1) + tweenData.repeatDelay * repeat;\n      now = appearNow >= now ? appearNow : now;\n    } else if (tweenData.delay < -tweenData.duration) {\n      // 如果延时小于 负时间时,,不加,再减回延时;\n      now -= tweenData.delay;\n    } else {\n      // repeat 为 -1 只记录一次。不能跟 reverse 同时使用;\n      now += tweenData.duration * (repeat + 1) + tweenData.repeatDelay * repeat;\n    }\n\n    tweenData.mode = '';\n    return tweenData;\n  });\n\n  this.totalTime = repeatMax ? Number.MAX_VALUE : now;\n  this.defaultData = data;\n};\n\np.getComputedStyle = function () {\n  var style = typeof window !== 'undefined' && document.defaultView ? document.defaultView.getComputedStyle(this.target) : {}; // 如果是 SVG, 样式全部提出为 transformSVG, 兼容 safari 不能获取 transform;\n\n  if (this.isSvg) {\n    var transform = style[checkStyleName('transform')] || 'none';\n\n    if (transform === 'none') {\n      var attrStyle = this.target.getAttribute('style');\n\n      if (attrStyle && attrStyle.indexOf('transform:') >= 0) {\n        transform = attrStyle.split(';').filter(function (k) {\n          return k.indexOf('transform:') >= 0;\n        }).map(function (item) {\n          return createMatrix(item.split(':')[1].trim()).toString();\n        })[0];\n      } else if (this.target.getAttribute('transform')) {\n        // 暂时不支持标签上的 transform，后期增加;\n        console.warn('Do not add transform on the label, otherwise it will be invalid.'); // eslint-disable-line no-console\n      }\n    }\n\n    style.transformSVG = transform;\n  }\n\n  return style;\n};\n\np.getAnimStartData = function (item) {\n  var _this3 = this;\n\n  var start = {};\n  Object.keys(item).forEach(function (_key) {\n    if (_key in _plugin || _this3.attr === 'attr' && (_key === 'd' || _key === 'points')) {\n      _this3.computedStyle = _this3.computedStyle || (!_this3.target.getAttribute ? _extends({}, _this3.target) : _this3.getComputedStyle());\n      start[_key] = item[_key].getAnimStart(_this3.computedStyle, _this3.tween, _this3.isSvg);\n      return;\n    }\n\n    if (_this3.attr === 'attr') {\n      // 除了d和这points外的标签动画；\n      var attribute = _this3.getValue(_key);\n\n      var s = _key.match(/opacity/ig) ? 1 : 0;\n      var data = attribute === 'null' || !attribute ? s : attribute;\n\n      if (_key.match(/color/i) || _key === 'stroke' || _key === 'fill') {\n        data = !data && _key === 'stroke' ? 'rgba(255, 255, 255, 0)' : data;\n        data = parseColor(data);\n        start[_key] = data;\n      } else if (parseFloat(data) || parseFloat(data) === 0 || data === 0) {\n        var unit = data.toString().replace(/[^a-z|%]/g, '');\n        start[_key] = unit !== item[_key].unit ? startConvertToEndUnit(_this3.target, _key, parseFloat(data), unit, item[_key].unit) : parseFloat(data);\n      }\n\n      return;\n    }\n\n    start[_key] = _this3.target[_key] || 0;\n  });\n  return start;\n};\n\np.setAnimData = function (data) {\n  var _this4 = this;\n\n  Object.keys(data).forEach(function (key) {\n    if (key in _plugin || _this4.attr === 'attr' && (key === 'd' || key === 'points')) {\n      return;\n    }\n\n    _this4.target[key] = data[key];\n  });\n};\n\np.setRatio = function (ratio, endData, i) {\n  var _this5 = this;\n\n  Object.keys(endData.vars).forEach(function (_key) {\n    if (_key in _plugin || _this5.attr === 'attr' && (_key === 'd' || _key === 'points')) {\n      endData.vars[_key].setRatio(ratio, _this5.tween, _this5.isSvg && _this5.computedStyle);\n\n      return;\n    }\n\n    var endVars = endData.vars[_key];\n    var startVars = _this5.start[i][_key];\n    var data = void 0;\n\n    if (_this5.attr === 'attr') {\n      // 除了d和这points外的标签动画；\n      if (!endVars.type) {\n        data = endVars.unit.charAt(1) === '=' ? startVars + endVars.vars * ratio + endVars.unit : (endVars.vars - startVars) * ratio + startVars + endVars.unit;\n\n        _this5.setValue(_key, endVars.unit ? data : parseFloat(data));\n      } else if (endVars.type === 'color') {\n        if (endVars.vars.length === 3 && startVars.length === 4) {\n          endVars.vars[3] = 1;\n        }\n\n        data = endVars.vars.map(function (_endData, _i) {\n          var startData = startVars[_i] || 0;\n          return (_endData - startData) * ratio + startData;\n        });\n\n        _this5.setValue(_key, getColor(data));\n      }\n    }\n  });\n  this.setAnimData(this.tween);\n};\n\np.getValue = function (key) {\n  return this.target.getAttribute ? this.target.getAttribute(key) : this.target[key];\n};\n\np.setValue = function (key, value) {\n  if (this.target.setAttribute) {\n    this.target.setAttribute(key, value);\n  } else {\n    this.target[key] = value;\n  }\n};\n\np.render = function () {\n  var _this6 = this;\n\n  var reverse = this.reverse;\n  this.defaultData.forEach(function (item, i) {\n    var initTime = item.initTime;\n    var duration = toFixed(item.duration); // 处理 yoyo 和 repeat; yoyo 是在时间轴上的, 并不是倒放\n\n    var repeatNum = Math.ceil((_this6.progressTime - initTime) / (duration + item.repeatDelay)) - 1 || 0;\n    repeatNum = repeatNum < 0 ? 0 : repeatNum;\n\n    if (item.repeat) {\n      if (item.repeat < repeatNum && item.repeat !== -1) {\n        return;\n      }\n\n      if (item.repeat || item.repeat <= repeatNum) {\n        initTime += repeatNum * (duration + item.repeatDelay);\n      }\n    }\n\n    var startData = item.yoyo && repeatNum % 2 ? 1 : 0;\n    var endData = item.yoyo && repeatNum % 2 ? 0 : 1;\n    startData = item.type === 'from' ? 1 - startData : startData;\n    endData = item.type === 'from' ? 1 - endData : endData; //  精度损失，只取小数点后10位。\n\n    var progressTime = toFixed(_this6.progressTime - initTime);\n    var ratio = void 0; // 开始注册;\n    // from 时需先执行参数位置;\n\n    var fromDelay = item.type === 'from' ? item.delay : 0;\n\n    if (progressTime + fromDelay >= 0) {\n      if (!_this6.start[i]) {\n        // 设置 start\n        _this6.start[i] = _this6.getAnimStartData(item.vars);\n\n        if (progressTime < _this6.perFrame) {\n          ratio = !item.duration && !item.delay ? item.ease(1, startData, endData, 1) : item.ease(0, startData, endData, 1);\n\n          _this6.setRatio(ratio, item, i);\n        } else if (progressTime > duration) {\n          ratio = item.ease(1, startData, endData, 1);\n\n          _this6.setRatio(ratio, item, i);\n        }\n\n        if (!_this6.register || i && !initTime) {\n          _this6.register = true;\n\n          if (progressTime === 0 && item.duration && item.delay) {\n            return;\n          }\n        }\n      }\n    }\n\n    var e = {\n      index: i,\n      target: _this6.target\n    };\n\n    var cb = _extends({\n      moment: _this6.progressTime\n    }, e);\n\n    var maxPer = _this6.perFrame - _this6.accuracy;\n    var startTime = item.delay && reverse ? -maxPer : 0;\n\n    if ((progressTime >= startTime && !(progressTime > duration && item.mode === 'onComplete') || progressTime < startTime && item.mode && item.mode !== 'onStart') && _this6.start[i]) {\n      var updateAnim = _this6.updateAnim === 'update';\n      progressTime = progressTime < maxPer && !reverse && item.duration >= _this6.perFrame ? 0 : progressTime;\n\n      if ((progressTime >= duration - _this6.accuracy && !reverse || reverse && progressTime <= 0) && repeatNum >= item.repeat) {\n        if (item.mode === 'onComplete') {\n          return;\n        } // onReveresComplete 和 onComplete 统一用 onComplete;\n\n\n        ratio = item.ease(reverse ? 0 : 1, startData, endData, 1);\n\n        _this6.setRatio(ratio, item, i, item.currentRepeat !== repeatNum);\n\n        if ((!item.reset || item.reset && progressTime >= duration) && !updateAnim) {\n          // duration 为 0 时的一个回调；\n          if (duration < maxPer) {\n            if (!duration) {\n              item.onStart(e);\n              cb.mode = 'onStart';\n\n              _this6.onChange(cb);\n            }\n\n            item.onUpdate(_extends({\n              ratio: ratio\n            }, e));\n            cb.mode = 'onUpdate';\n\n            _this6.onChange(cb);\n          }\n\n          item.onComplete(e);\n        } else if (progressTime >= duration + maxPer) {\n          return;\n        }\n\n        item.mode = 'onComplete';\n      } else if (duration > maxPer) {\n        var currentProgress = progressTime < 0 ? 0 : progressTime;\n        currentProgress = currentProgress > duration ? duration : currentProgress;\n        ratio = item.ease(currentProgress, startData, endData, duration);\n\n        _this6.setRatio(ratio, item, i);\n\n        if (!updateAnim) {\n          if (item.repeat && repeatNum > 0 && item.currentRepeat !== repeatNum) {\n            item.mode = 'onRepeat';\n            item.currentRepeat = repeatNum;\n            item.onRepeat(_extends({}, e, {\n              repeatNum: repeatNum\n            }));\n          } else if ((item.perTime <= 0 || reverse && item.perTime >= _this6.reverseStartTime - initTime) && item.mode !== 'onStart') {\n            // onReveresStart 和 onStart 统一用 onStart;\n            item.mode = 'onStart';\n            item.onStart(e);\n          } else {\n            item.mode = 'onUpdate';\n            item.onUpdate(_extends({\n              ratio: ratio\n            }, e));\n          }\n        }\n      }\n\n      if (!updateAnim) {\n        cb.mode = item.mode;\n\n        _this6.onChange(cb);\n      }\n\n      item.perTime = progressTime;\n\n      if (item.reset) {\n        delete item.reset;\n      }\n    }\n  });\n}; // 播放帧\n\n\np.frame = function (moment) {\n  var _this7 = this;\n\n  this.progressTime = moment;\n  this.defaultData.forEach(function (item) {\n    var t = _this7.progressTime - item.duration - item.initTime;\n\n    if (t < _this7.perFrame && t > 0) {\n      _this7.progressTime = item.duration + item.initTime;\n    }\n  });\n  this.render();\n};\n\np.init = p.frame;\n\np.resetAnimData = function () {\n  this.tween = {};\n  this.start = {};\n};\n\nvar getDefaultStyle = function getDefaultStyle(domStyle, defaultStyle, tweenData) {\n  var $data = defaultData({}, 0);\n\n  var getStyleToArray = function getStyleToArray(styleString) {\n    return styleString.split(';').filter(function (c) {\n      return c;\n    }).map(function (str) {\n      return str.split(':').map(function (s) {\n        return s.trim();\n      });\n    });\n  };\n\n  var styleToArray = getStyleToArray(defaultStyle);\n  var domStyleToArray = getStyleToArray(domStyle);\n  tweenData.forEach(function (value) {\n    Object.keys(value).forEach(function (name) {\n      if (!(name in $data)) {\n        var $name = name === 'bezier' ? 'transform' : name;\n        var styleName = toCssLowerCase(isTransform(getGsapType($name)));\n        domStyleToArray = domStyleToArray.filter(function (item) {\n          // 去除 plugins 的特殊名称。\n          if (transformOrFilter[item[0]] && transformOrFilter[styleName]) {\n            return false;\n          }\n\n          return item[0] !== styleName;\n        });\n      }\n    });\n  });\n  styleToArray.forEach(function (item) {\n    domStyleToArray = domStyleToArray.filter(function ($item) {\n      if ($item[0] === item[0]) {\n        return false;\n      }\n\n      return true;\n    });\n  });\n  return styleToArray.concat(domStyleToArray).map(function (item) {\n    return item.join(':');\n  }).join(';');\n};\n\np.resetDefaultStyle = function () {\n  var _this8 = this;\n\n  this.tween = {};\n  this.defaultData = this.defaultData.map(function (item) {\n    item.reset = true;\n    delete item.mode;\n    return item;\n  });\n  var data = defaultData({}, 0);\n  Object.keys(this.startDefaultData).forEach(function (key) {\n    if (!(key in data)) {\n      if (key === 'style') {\n        var value = getDefaultStyle(_this8.target.style.cssText, _this8.startDefaultData.style, _this8.data);\n\n        _this8.setValue(key, value);\n      } else {\n        _this8.setValue(key, _this8.startDefaultData[key]);\n      }\n\n      _this8.computedStyle = null;\n    }\n  });\n};\n\np.reStart = function (style, preStyle, isTween) {\n  var _this9 = this;\n\n  this.start = {};\n  this.tween = {};\n  Object.keys(style || {}).forEach(function (key) {\n    if (isTween || !preStyle || style[key] !== preStyle[key]) {\n      _this9.target.style[key] = stylesToCss(key, style[key]);\n    }\n  });\n  this.setAttrIsStyle();\n  this.computedStyle = null;\n};\n\np.onChange = noop;\nexport default Tween;","map":{"version":3,"sources":["/Users/manhsy/Developer/manhsy-portfolio/node_modules/rc-tween-one/es/Tween.js"],"names":["_extends","getColor","parseColor","toFixed","stylesToCss","createMatrix","getGsapType","isTransform","checkStyleName","toCssLowerCase","easingTypes","_plugin","StylePlugin","startConvertToEndUnit","transformOrFilter","dataToArray","DEFAULT_EASING","DEFAULT_DURATION","DEFAULT_DELAY","noop","push","defaultData","vars","now","duration","type","delay","ease","onUpdate","onComplete","onStart","onRepeat","repeat","repeatDelay","yoyo","initTime","appearTo","perTime","currentRepeat","Tween","target","to","attr","toData","accuracy","totalTime","progressTime","start","startDefaultData","tween","data","perFrame","Math","round","register","isSvg","ownerSVGElement","setAttrIsStyle","setDefaultData","p","prototype","_this","defaultParam","forEach","d","i","_d","Object","keys","key","style","getAttribute","Array","isArray","Error","bezier","getValue","_vars","_this2","repeatMax","map","item","appearToBool","appearToTime","tweenData","_key","_data","SVGMorph","match","split","length","parseFloat","unit","toString","replace","count","console","warn","appearNow","mode","Number","MAX_VALUE","getComputedStyle","window","document","defaultView","transform","attrStyle","indexOf","filter","k","trim","transformSVG","getAnimStartData","_this3","computedStyle","getAnimStart","attribute","s","setAnimData","_this4","setRatio","ratio","endData","_this5","endVars","startVars","charAt","setValue","_endData","_i","startData","value","setAttribute","render","_this6","reverse","repeatNum","ceil","fromDelay","e","index","cb","moment","maxPer","startTime","updateAnim","reset","onChange","currentProgress","reverseStartTime","frame","_this7","t","init","resetAnimData","getDefaultStyle","domStyle","defaultStyle","$data","getStyleToArray","styleString","c","str","styleToArray","domStyleToArray","name","$name","styleName","$item","concat","join","resetDefaultStyle","_this8","cssText","reStart","preStyle","isTween","_this9"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\n/* eslint-disable func-names */\n/**\n * Created by jljsj on 16/1/27.\n */\nimport { getColor, parseColor, toFixed, stylesToCss, createMatrix, getGsapType, isTransform, checkStyleName, toCssLowerCase } from 'style-utils';\n\nimport easingTypes from './easing';\nimport _plugin from './plugins';\nimport StylePlugin from './plugin/StylePlugin';\nimport { startConvertToEndUnit, transformOrFilter, dataToArray } from './util.js';\n\nvar DEFAULT_EASING = 'easeInOutQuad';\nvar DEFAULT_DURATION = 450;\nvar DEFAULT_DELAY = 0;\nfunction noop() {}\n_plugin.push(StylePlugin);\n// 设置默认数据\nfunction defaultData(vars, now) {\n  var duration = vars.duration || vars.duration === 0 ? vars.duration : DEFAULT_DURATION;\n  return {\n    duration: vars.type === 'set' ? 0 : duration,\n    delay: vars.delay || DEFAULT_DELAY,\n    ease: typeof vars.ease === 'function' ? vars.ease : easingTypes[vars.ease || DEFAULT_EASING],\n    onUpdate: vars.onUpdate || noop,\n    onComplete: vars.onComplete || noop,\n    onStart: vars.onStart || noop,\n    onRepeat: vars.onRepeat || noop,\n    repeat: vars.repeat || 0,\n    repeatDelay: vars.repeatDelay || 0,\n    yoyo: vars.yoyo || false,\n    type: vars.type === 'from' ? 'from' : 'to',\n    initTime: now,\n    appearTo: typeof vars.appearTo === 'number' ? vars.appearTo : null,\n    perTime: 0,\n    currentRepeat: 0\n  };\n}\n\nvar Tween = function Tween(target, to, attr) {\n  var toData = dataToArray(to);\n  this.target = target;\n  this.attr = attr || 'style';\n  // 时间精度补齐；\n  this.accuracy = 0.00001;\n  // 记录总时间;\n  this.totalTime = 0;\n  // 记录当前时间;\n  this.progressTime = 0;\n  // 记录时间轴数据;\n  this.defaultData = [];\n  // 每个的开始数据；\n  this.start = {};\n  // 开始默认的数据；\n  this.startDefaultData = {};\n  // 动画过程\n  this.tween = {};\n  // toData;\n  this.data = toData;\n  // 每帧的时间;\n  this.perFrame = Math.round(1000 / 60);\n  // 注册，第一次进入执行注册\n  this.register = false;\n  // svg元素\n  this.isSvg = this.target.ownerSVGElement;\n  // 设置 style\n  var data = this.setAttrIsStyle();\n  // 设置默认动画数据;\n  this.setDefaultData(data);\n};\nvar p = Tween.prototype;\np.setAttrIsStyle = function () {\n  var _this = this;\n\n  var data = [];\n  var defaultParam = defaultData({}, 0);\n  this.data.forEach(function (d, i) {\n    var _d = _extends({}, d);\n    if (_this.attr === 'style') {\n      data[i] = {};\n      Object.keys(_d).forEach(function (key) {\n        if (key in defaultParam) {\n          data[i][key] = _d[key];\n          delete _d[key];\n        }\n      });\n      data[i].style = _d;\n      _this.startDefaultData.style = _this.target.getAttribute('style') || '';\n    } else if (_this.attr === 'attr') {\n      Object.keys(_d).forEach(function (key) {\n        if (key === 'style' && Array.isArray(d[key])) {\n          throw new Error('Style should be the object.');\n        }\n        if (key === 'bezier') {\n          _d.style = _extends({}, _d.style, { bezier: _d[key] });\n          delete _d[key];\n          _this.startDefaultData.style = _this.target.getAttribute('style') || '';\n        } else {\n          if (key in defaultParam) {\n            return;\n          }\n          _this.startDefaultData[key] = _this.getValue(key);\n        }\n      });\n      data[i] = _d;\n    }\n  });\n  return data;\n};\np.setDefaultData = function (_vars) {\n  var _this2 = this;\n\n  var now = 0;\n  var repeatMax = false;\n  var data = _vars.map(function (item) {\n    var appearToBool = typeof item.appearTo === 'number';\n    // 加上延时，在没有播放过时；\n    if (!appearToBool) {\n      now += item.delay || 0;\n    }\n    var appearToTime = (item.appearTo || 0) + (item.delay || 0);\n    // 获取默认数据\n    var tweenData = defaultData(item, appearToBool ? appearToTime : now);\n    tweenData.vars = {};\n    Object.keys(item).forEach(function (_key) {\n      if (!(_key in tweenData)) {\n        var _data = item[_key];\n        if (_key in _plugin) {\n          tweenData.vars[_key] = new _plugin[_key](_this2.target, _data, tweenData.type);\n        } else if ((_key === 'd' || _key === 'points') && 'SVGMorph' in _plugin) {\n          tweenData.vars[_key] = new _plugin.SVGMorph(_this2.target, _data, _key);\n        } else if (_key.match(/color/i) || _key === 'stroke' || _key === 'fill') {\n          tweenData.vars[_key] = { type: 'color', vars: parseColor(_data) };\n        } else if (typeof _data === 'number' || _data.split(/[,|\\s]/g).length <= 1) {\n          var vars = parseFloat(_data);\n          var unit = _data.toString().replace(/[^a-z|%]/g, '');\n          var count = _data.toString().replace(/[^+|=|-]/g, '');\n          tweenData.vars[_key] = { unit: unit, vars: vars, count: count };\n        }\n      }\n    });\n    if (tweenData.yoyo && !tweenData.repeat) {\n      console.warn('Warning: yoyo must be used together with repeat;'); // eslint-disable-line\n    }\n    if (tweenData.repeat === -1) {\n      repeatMax = true;\n    }\n    var repeat = tweenData.repeat === -1 ? 0 : tweenData.repeat;\n    if (appearToBool) {\n      // 如果有 appearTo 且这条时间比 now 大时，，总时间用这条；\n      var appearNow = item.appearTo + (item.delay || 0) + tweenData.duration * (repeat + 1) + tweenData.repeatDelay * repeat;\n      now = appearNow >= now ? appearNow : now;\n    } else if (tweenData.delay < -tweenData.duration) {\n      // 如果延时小于 负时间时,,不加,再减回延时;\n      now -= tweenData.delay;\n    } else {\n      // repeat 为 -1 只记录一次。不能跟 reverse 同时使用;\n      now += tweenData.duration * (repeat + 1) + tweenData.repeatDelay * repeat;\n    }\n    tweenData.mode = '';\n    return tweenData;\n  });\n  this.totalTime = repeatMax ? Number.MAX_VALUE : now;\n  this.defaultData = data;\n};\np.getComputedStyle = function () {\n  var style = typeof window !== 'undefined' && document.defaultView ? document.defaultView.getComputedStyle(this.target) : {};\n  // 如果是 SVG, 样式全部提出为 transformSVG, 兼容 safari 不能获取 transform;\n  if (this.isSvg) {\n    var transform = style[checkStyleName('transform')] || 'none';\n    if (transform === 'none') {\n      var attrStyle = this.target.getAttribute('style');\n      if (attrStyle && attrStyle.indexOf('transform:') >= 0) {\n        transform = attrStyle.split(';').filter(function (k) {\n          return k.indexOf('transform:') >= 0;\n        }).map(function (item) {\n          return createMatrix(item.split(':')[1].trim()).toString();\n        })[0];\n      } else if (this.target.getAttribute('transform')) {\n        // 暂时不支持标签上的 transform，后期增加;\n        console.warn('Do not add transform on the label, otherwise it will be invalid.'); // eslint-disable-line no-console\n      }\n    }\n    style.transformSVG = transform;\n  }\n  return style;\n};\np.getAnimStartData = function (item) {\n  var _this3 = this;\n\n  var start = {};\n  Object.keys(item).forEach(function (_key) {\n    if (_key in _plugin || _this3.attr === 'attr' && (_key === 'd' || _key === 'points')) {\n      _this3.computedStyle = _this3.computedStyle || (!_this3.target.getAttribute ? _extends({}, _this3.target) : _this3.getComputedStyle());\n      start[_key] = item[_key].getAnimStart(_this3.computedStyle, _this3.tween, _this3.isSvg);\n      return;\n    }\n    if (_this3.attr === 'attr') {\n      // 除了d和这points外的标签动画；\n      var attribute = _this3.getValue(_key);\n      var s = _key.match(/opacity/ig) ? 1 : 0;\n      var data = attribute === 'null' || !attribute ? s : attribute;\n      if (_key.match(/color/i) || _key === 'stroke' || _key === 'fill') {\n        data = !data && _key === 'stroke' ? 'rgba(255, 255, 255, 0)' : data;\n        data = parseColor(data);\n        start[_key] = data;\n      } else if (parseFloat(data) || parseFloat(data) === 0 || data === 0) {\n        var unit = data.toString().replace(/[^a-z|%]/g, '');\n        start[_key] = unit !== item[_key].unit ? startConvertToEndUnit(_this3.target, _key, parseFloat(data), unit, item[_key].unit) : parseFloat(data);\n      }\n      return;\n    }\n    start[_key] = _this3.target[_key] || 0;\n  });\n  return start;\n};\np.setAnimData = function (data) {\n  var _this4 = this;\n\n  Object.keys(data).forEach(function (key) {\n    if (key in _plugin || _this4.attr === 'attr' && (key === 'd' || key === 'points')) {\n      return;\n    }\n    _this4.target[key] = data[key];\n  });\n};\np.setRatio = function (ratio, endData, i) {\n  var _this5 = this;\n\n  Object.keys(endData.vars).forEach(function (_key) {\n    if (_key in _plugin || _this5.attr === 'attr' && (_key === 'd' || _key === 'points')) {\n      endData.vars[_key].setRatio(ratio, _this5.tween, _this5.isSvg && _this5.computedStyle);\n      return;\n    }\n    var endVars = endData.vars[_key];\n    var startVars = _this5.start[i][_key];\n    var data = void 0;\n    if (_this5.attr === 'attr') {\n      // 除了d和这points外的标签动画；\n      if (!endVars.type) {\n        data = endVars.unit.charAt(1) === '=' ? startVars + endVars.vars * ratio + endVars.unit : (endVars.vars - startVars) * ratio + startVars + endVars.unit;\n        _this5.setValue(_key, endVars.unit ? data : parseFloat(data));\n      } else if (endVars.type === 'color') {\n        if (endVars.vars.length === 3 && startVars.length === 4) {\n          endVars.vars[3] = 1;\n        }\n        data = endVars.vars.map(function (_endData, _i) {\n          var startData = startVars[_i] || 0;\n          return (_endData - startData) * ratio + startData;\n        });\n        _this5.setValue(_key, getColor(data));\n      }\n    }\n  });\n  this.setAnimData(this.tween);\n};\np.getValue = function (key) {\n  return this.target.getAttribute ? this.target.getAttribute(key) : this.target[key];\n};\np.setValue = function (key, value) {\n  if (this.target.setAttribute) {\n    this.target.setAttribute(key, value);\n  } else {\n    this.target[key] = value;\n  }\n};\np.render = function () {\n  var _this6 = this;\n\n  var reverse = this.reverse;\n  this.defaultData.forEach(function (item, i) {\n    var initTime = item.initTime;\n    var duration = toFixed(item.duration);\n    // 处理 yoyo 和 repeat; yoyo 是在时间轴上的, 并不是倒放\n    var repeatNum = Math.ceil((_this6.progressTime - initTime) / (duration + item.repeatDelay)) - 1 || 0;\n    repeatNum = repeatNum < 0 ? 0 : repeatNum;\n    if (item.repeat) {\n      if (item.repeat < repeatNum && item.repeat !== -1) {\n        return;\n      }\n      if (item.repeat || item.repeat <= repeatNum) {\n        initTime += repeatNum * (duration + item.repeatDelay);\n      }\n    }\n    var startData = item.yoyo && repeatNum % 2 ? 1 : 0;\n    var endData = item.yoyo && repeatNum % 2 ? 0 : 1;\n    startData = item.type === 'from' ? 1 - startData : startData;\n    endData = item.type === 'from' ? 1 - endData : endData;\n    //  精度损失，只取小数点后10位。\n    var progressTime = toFixed(_this6.progressTime - initTime);\n\n    var ratio = void 0;\n\n    // 开始注册;\n    // from 时需先执行参数位置;\n    var fromDelay = item.type === 'from' ? item.delay : 0;\n    if (progressTime + fromDelay >= 0) {\n      if (!_this6.start[i]) {\n        // 设置 start\n        _this6.start[i] = _this6.getAnimStartData(item.vars);\n        if (progressTime < _this6.perFrame) {\n          ratio = !item.duration && !item.delay ? item.ease(1, startData, endData, 1) : item.ease(0, startData, endData, 1);\n          _this6.setRatio(ratio, item, i);\n        } else if (progressTime > duration) {\n          ratio = item.ease(1, startData, endData, 1);\n          _this6.setRatio(ratio, item, i);\n        }\n        if (!_this6.register || i && !initTime) {\n          _this6.register = true;\n          if (progressTime === 0 && item.duration && item.delay) {\n            return;\n          }\n        }\n      }\n    }\n\n    var e = {\n      index: i,\n      target: _this6.target\n    };\n    var cb = _extends({\n      moment: _this6.progressTime\n    }, e);\n    var maxPer = _this6.perFrame - _this6.accuracy;\n    var startTime = item.delay && reverse ? -maxPer : 0;\n    if ((progressTime >= startTime && !(progressTime > duration && item.mode === 'onComplete') || progressTime < startTime && item.mode && item.mode !== 'onStart') && _this6.start[i]) {\n      var updateAnim = _this6.updateAnim === 'update';\n      progressTime = progressTime < maxPer && !reverse && item.duration >= _this6.perFrame ? 0 : progressTime;\n      if ((progressTime >= duration - _this6.accuracy && !reverse || reverse && progressTime <= 0) && repeatNum >= item.repeat) {\n        if (item.mode === 'onComplete') {\n          return;\n        }\n        // onReveresComplete 和 onComplete 统一用 onComplete;\n        ratio = item.ease(reverse ? 0 : 1, startData, endData, 1);\n        _this6.setRatio(ratio, item, i, item.currentRepeat !== repeatNum);\n        if ((!item.reset || item.reset && progressTime >= duration) && !updateAnim) {\n          // duration 为 0 时的一个回调；\n          if (duration < maxPer) {\n            if (!duration) {\n              item.onStart(e);\n              cb.mode = 'onStart';\n              _this6.onChange(cb);\n            }\n            item.onUpdate(_extends({ ratio: ratio }, e));\n            cb.mode = 'onUpdate';\n            _this6.onChange(cb);\n          }\n          item.onComplete(e);\n        } else if (progressTime >= duration + maxPer) {\n          return;\n        }\n        item.mode = 'onComplete';\n      } else if (duration > maxPer) {\n        var currentProgress = progressTime < 0 ? 0 : progressTime;\n        currentProgress = currentProgress > duration ? duration : currentProgress;\n        ratio = item.ease(currentProgress, startData, endData, duration);\n        _this6.setRatio(ratio, item, i);\n        if (!updateAnim) {\n          if (item.repeat && repeatNum > 0 && item.currentRepeat !== repeatNum) {\n            item.mode = 'onRepeat';\n            item.currentRepeat = repeatNum;\n            item.onRepeat(_extends({}, e, { repeatNum: repeatNum }));\n          } else if ((item.perTime <= 0 || reverse && item.perTime >= _this6.reverseStartTime - initTime) && item.mode !== 'onStart') {\n            // onReveresStart 和 onStart 统一用 onStart;\n            item.mode = 'onStart';\n            item.onStart(e);\n          } else {\n            item.mode = 'onUpdate';\n            item.onUpdate(_extends({ ratio: ratio }, e));\n          }\n        }\n      }\n\n      if (!updateAnim) {\n        cb.mode = item.mode;\n        _this6.onChange(cb);\n      }\n      item.perTime = progressTime;\n      if (item.reset) {\n        delete item.reset;\n      }\n    }\n  });\n};\n// 播放帧\np.frame = function (moment) {\n  var _this7 = this;\n\n  this.progressTime = moment;\n  this.defaultData.forEach(function (item) {\n    var t = _this7.progressTime - item.duration - item.initTime;\n    if (t < _this7.perFrame && t > 0) {\n      _this7.progressTime = item.duration + item.initTime;\n    }\n  });\n  this.render();\n};\n\np.init = p.frame;\n\np.resetAnimData = function () {\n  this.tween = {};\n  this.start = {};\n};\n\nvar getDefaultStyle = function getDefaultStyle(domStyle, defaultStyle, tweenData) {\n  var $data = defaultData({}, 0);\n  var getStyleToArray = function getStyleToArray(styleString) {\n    return styleString.split(';').filter(function (c) {\n      return c;\n    }).map(function (str) {\n      return str.split(':').map(function (s) {\n        return s.trim();\n      });\n    });\n  };\n  var styleToArray = getStyleToArray(defaultStyle);\n  var domStyleToArray = getStyleToArray(domStyle);\n  tweenData.forEach(function (value) {\n    Object.keys(value).forEach(function (name) {\n      if (!(name in $data)) {\n        var $name = name === 'bezier' ? 'transform' : name;\n        var styleName = toCssLowerCase(isTransform(getGsapType($name)));\n        domStyleToArray = domStyleToArray.filter(function (item) {\n          // 去除 plugins 的特殊名称。\n          if (transformOrFilter[item[0]] && transformOrFilter[styleName]) {\n            return false;\n          }\n          return item[0] !== styleName;\n        });\n      }\n    });\n  });\n  styleToArray.forEach(function (item) {\n    domStyleToArray = domStyleToArray.filter(function ($item) {\n      if ($item[0] === item[0]) {\n        return false;\n      }\n      return true;\n    });\n  });\n  return styleToArray.concat(domStyleToArray).map(function (item) {\n    return item.join(':');\n  }).join(';');\n};\n\np.resetDefaultStyle = function () {\n  var _this8 = this;\n\n  this.tween = {};\n  this.defaultData = this.defaultData.map(function (item) {\n    item.reset = true;\n    delete item.mode;\n    return item;\n  });\n  var data = defaultData({}, 0);\n  Object.keys(this.startDefaultData).forEach(function (key) {\n    if (!(key in data)) {\n      if (key === 'style') {\n        var value = getDefaultStyle(_this8.target.style.cssText, _this8.startDefaultData.style, _this8.data);\n        _this8.setValue(key, value);\n      } else {\n        _this8.setValue(key, _this8.startDefaultData[key]);\n      }\n      _this8.computedStyle = null;\n    }\n  });\n};\n\np.reStart = function (style, preStyle, isTween) {\n  var _this9 = this;\n\n  this.start = {};\n  this.tween = {};\n  Object.keys(style || {}).forEach(function (key) {\n    if (isTween || !preStyle || style[key] !== preStyle[key]) {\n      _this9.target.style[key] = stylesToCss(key, style[key]);\n    }\n  });\n  this.setAttrIsStyle();\n  this.computedStyle = null;\n};\n\np.onChange = noop;\nexport default Tween;"]},"metadata":{},"sourceType":"module"}