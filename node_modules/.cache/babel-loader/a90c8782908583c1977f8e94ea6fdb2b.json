{"ast":null,"code":"/* eslint-disable func-names */\nimport requestAnimationFrame from 'raf';\n\nvar getTime = Date.now || function () {\n  return new Date().getTime();\n};\n\nvar sortObj = {\n  interval: 1,\n  timeout: 1,\n  TweenOneTicker: 2\n};\n\nvar tickObjToArray = function tickObjToArray(obj) {\n  return Object.keys(obj).map(function (k) {\n    return {\n      key: k,\n      func: obj[k]\n    };\n  }).sort(function (a, b) {\n    var aa = a.key.split('_')[0];\n    var bb = b.key.split('_')[0];\n    return sortObj[bb] - sortObj[aa];\n  });\n};\n\nvar Ticker = function Ticker() {};\n\nTicker.prototype = {\n  tickFnArray: [],\n  tickKeyObject: {},\n  id: -1,\n  tweenId: 0,\n  frame: 0,\n  perFrame: Math.round(1000 / 60),\n  elapsed: 0,\n  lastUpdate: getTime(),\n  startTime: getTime(),\n  // 开始时间，不计算 react 渲染时间；\n  nextTime: 0,\n  time: 0\n};\nvar p = Ticker.prototype;\n\np.add = function (fn) {\n  var key = 'TweenOneTicker_' + this.tweenId;\n  this.tweenId++;\n  this.wake(key, fn);\n  return key;\n};\n\np.wake = function (key, fn) {\n  this.tickKeyObject[key] = fn;\n  this.tickFnArray = tickObjToArray(this.tickKeyObject);\n\n  if (this.id === -1) {\n    this.id = requestAnimationFrame(this.tick);\n  }\n};\n\np.clear = function (key) {\n  delete this.tickKeyObject[key];\n  this.tickFnArray = tickObjToArray(this.tickKeyObject);\n};\n\np.sleep = function () {\n  requestAnimationFrame.cancel(this.id);\n  this.id = -1;\n  this.frame = 0;\n};\n\nvar ticker = new Ticker();\n\np.tick = function (a) {\n  ticker.elapsed = getTime() - ticker.lastUpdate; // 离开当前时设值 300；大于 300 则为离开。\n\n  if (ticker.elapsed > 300) {\n    ticker.startTime += ticker.elapsed - ticker.perFrame;\n  }\n\n  ticker.lastUpdate += ticker.elapsed;\n  ticker.time = ticker.lastUpdate - ticker.startTime;\n  var overlap = ticker.time - ticker.nextTime;\n\n  if (overlap > 0 || !ticker.frame) {\n    ticker.frame++;\n    ticker.nextTime += overlap;\n  } // console.log(ticker.frame, ticker.nextTime, ticker.time)\n\n\n  ticker.tickFnArray.forEach(function (item) {\n    return item.func(a);\n  }); // 如果 object 里没对象了，自动杀掉；\n\n  if (!ticker.tickFnArray.length) {\n    ticker.sleep();\n    return;\n  }\n\n  ticker.id = requestAnimationFrame(ticker.tick);\n};\n\nvar timeoutIdNumber = 0;\n\np.timeout = function (fn, time) {\n  var _this = this;\n\n  if (!(typeof fn === 'function')) {\n    return console.warn('not function'); // eslint-disable-line\n  }\n\n  var timeoutID = 'timeout_' + Date.now() + '-' + timeoutIdNumber;\n  var startTime = this.time;\n  this.wake(timeoutID, function () {\n    var moment = _this.time - startTime;\n\n    if (moment >= (time || 0)) {\n      _this.clear(timeoutID);\n\n      fn();\n    }\n  });\n  timeoutIdNumber++;\n  return timeoutID;\n};\n\nvar intervalIdNumber = 0;\n\np.interval = function (fn, time) {\n  var _this2 = this;\n\n  if (!(typeof fn === 'function')) {\n    console.warn('not function'); // eslint-disable-line\n\n    return null;\n  }\n\n  var intervalID = 'interval_' + Date.now() + '-' + intervalIdNumber;\n  var starTime = this.time;\n  this.wake(intervalID, function () {\n    var moment = _this2.time - starTime;\n\n    if (moment >= (time || 0)) {\n      starTime = _this2.time;\n      fn();\n    }\n  });\n  intervalIdNumber++;\n  return intervalID;\n};\n\nexport default ticker;","map":{"version":3,"sources":["/Users/manhsy/Developer/manhsy-portfolio/node_modules/rc-tween-one/es/ticker.js"],"names":["requestAnimationFrame","getTime","Date","now","sortObj","interval","timeout","TweenOneTicker","tickObjToArray","obj","Object","keys","map","k","key","func","sort","a","b","aa","split","bb","Ticker","prototype","tickFnArray","tickKeyObject","id","tweenId","frame","perFrame","Math","round","elapsed","lastUpdate","startTime","nextTime","time","p","add","fn","wake","tick","clear","sleep","cancel","ticker","overlap","forEach","item","length","timeoutIdNumber","_this","console","warn","timeoutID","moment","intervalIdNumber","_this2","intervalID","starTime"],"mappings":"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","sourcesContent":["/* eslint-disable func-names */\nimport requestAnimationFrame from 'raf';\n\nvar getTime = Date.now || function () {\n  return new Date().getTime();\n};\nvar sortObj = {\n  interval: 1,\n  timeout: 1,\n  TweenOneTicker: 2\n};\nvar tickObjToArray = function tickObjToArray(obj) {\n  return Object.keys(obj).map(function (k) {\n    return {\n      key: k,\n      func: obj[k]\n    };\n  }).sort(function (a, b) {\n    var aa = a.key.split('_')[0];\n    var bb = b.key.split('_')[0];\n    return sortObj[bb] - sortObj[aa];\n  });\n};\nvar Ticker = function Ticker() {};\nTicker.prototype = {\n  tickFnArray: [],\n  tickKeyObject: {},\n  id: -1,\n  tweenId: 0,\n  frame: 0,\n  perFrame: Math.round(1000 / 60),\n  elapsed: 0,\n  lastUpdate: getTime(),\n  startTime: getTime(), // 开始时间，不计算 react 渲染时间；\n  nextTime: 0,\n  time: 0\n};\nvar p = Ticker.prototype;\np.add = function (fn) {\n  var key = 'TweenOneTicker_' + this.tweenId;\n  this.tweenId++;\n  this.wake(key, fn);\n  return key;\n};\np.wake = function (key, fn) {\n  this.tickKeyObject[key] = fn;\n  this.tickFnArray = tickObjToArray(this.tickKeyObject);\n  if (this.id === -1) {\n    this.id = requestAnimationFrame(this.tick);\n  }\n};\np.clear = function (key) {\n  delete this.tickKeyObject[key];\n  this.tickFnArray = tickObjToArray(this.tickKeyObject);\n};\np.sleep = function () {\n  requestAnimationFrame.cancel(this.id);\n  this.id = -1;\n  this.frame = 0;\n};\nvar ticker = new Ticker();\np.tick = function (a) {\n  ticker.elapsed = getTime() - ticker.lastUpdate;\n  // 离开当前时设值 300；大于 300 则为离开。\n  if (ticker.elapsed > 300) {\n    ticker.startTime += ticker.elapsed - ticker.perFrame;\n  }\n  ticker.lastUpdate += ticker.elapsed;\n  ticker.time = ticker.lastUpdate - ticker.startTime;\n  var overlap = ticker.time - ticker.nextTime;\n  if (overlap > 0 || !ticker.frame) {\n    ticker.frame++;\n    ticker.nextTime += overlap;\n  }\n  // console.log(ticker.frame, ticker.nextTime, ticker.time)\n  ticker.tickFnArray.forEach(function (item) {\n    return item.func(a);\n  });\n  // 如果 object 里没对象了，自动杀掉；\n  if (!ticker.tickFnArray.length) {\n    ticker.sleep();\n    return;\n  }\n  ticker.id = requestAnimationFrame(ticker.tick);\n};\nvar timeoutIdNumber = 0;\np.timeout = function (fn, time) {\n  var _this = this;\n\n  if (!(typeof fn === 'function')) {\n    return console.warn('not function'); // eslint-disable-line\n  }\n  var timeoutID = 'timeout_' + Date.now() + '-' + timeoutIdNumber;\n  var startTime = this.time;\n  this.wake(timeoutID, function () {\n    var moment = _this.time - startTime;\n    if (moment >= (time || 0)) {\n      _this.clear(timeoutID);\n      fn();\n    }\n  });\n  timeoutIdNumber++;\n  return timeoutID;\n};\nvar intervalIdNumber = 0;\np.interval = function (fn, time) {\n  var _this2 = this;\n\n  if (!(typeof fn === 'function')) {\n    console.warn('not function'); // eslint-disable-line\n    return null;\n  }\n  var intervalID = 'interval_' + Date.now() + '-' + intervalIdNumber;\n  var starTime = this.time;\n  this.wake(intervalID, function () {\n    var moment = _this2.time - starTime;\n    if (moment >= (time || 0)) {\n      starTime = _this2.time;\n      fn();\n    }\n  });\n  intervalIdNumber++;\n  return intervalID;\n};\nexport default ticker;"]},"metadata":{},"sourceType":"module"}