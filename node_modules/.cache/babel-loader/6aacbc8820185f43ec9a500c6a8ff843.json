{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\n/* eslint-disable func-names, no-console */\n\nimport { cssList, checkStyleName, getGsapType, parseShadow, getColor, parseColor, isTransform, isConvert, splitFilterToObject, getTransform, stylesToCss, createMatrix } from 'style-utils';\nimport { startConvertToEndUnit, getTransformValue, styleValueToArray } from '../util.js';\nimport _plugin from '../plugins';\n\nvar StylePlugin = function StylePlugin(target, vars, type) {\n  this.target = target;\n  this.vars = vars;\n  this.type = type;\n  this.propsData = {};\n  this.setDefaultData();\n};\n\nStylePlugin.prototype = {\n  name: 'style'\n};\nvar p = StylePlugin.prototype;\n\np.getTweenData = function (key, $vars) {\n  var data = {\n    data: {},\n    dataType: {},\n    dataUnit: {},\n    dataCount: {},\n    dataSplitStr: {}\n  };\n  var vars = $vars;\n\n  if (styleValueToArray[key]) {\n    vars = vars.toString().split(' ');\n    vars = vars.map(function (c) {\n      return typeof $vars === 'number' ? c + 'px' : c;\n    });\n    vars[1] = vars[1] || vars[0];\n    vars[2] = vars[2] || vars[0];\n    vars[3] = vars[3] || vars[1] || vars[0];\n    vars = vars.join(' ');\n  }\n\n  if (key.match(/colo|fill|storker/i)) {\n    data.data[key] = parseColor(vars);\n    data.dataType[key] = 'color';\n  } else if (key === 'strokeDasharray') {\n    data.data[key] = vars.split(',');\n    data.dataType[key] = 'strokeDasharray';\n  } else if (key.match(/shadow/i)) {\n    data.data[key] = parseShadow(vars);\n    data.dataType[key] = 'shadow';\n  } else if (typeof vars === 'string' && vars.split(/[\\s|,]/).length > 1) {\n    data.data[key] = vars.split(/[\\s|,]/);\n    data.dataSplitStr[key] = vars.replace(/[^\\s|,]/g, '').replace(/\\s+/g, ' ');\n    data.dataType[key] = 'string';\n  } else {\n    data.data[key] = vars;\n    data.dataType[key] = 'other';\n  }\n\n  if (Array.isArray(data.data[key])) {\n    data.dataUnit[key] = data.data[key].map(function (_item) {\n      return _item.toString().replace(/[^a-z|%]/g, '');\n    });\n    data.dataCount[key] = data.data[key].map(function (_item) {\n      return _item.toString().replace(/[^+|=|-]/g, '');\n    });\n    data.data[key] = data.data[key].map(function (_item) {\n      return !parseFloat(_item) && parseFloat(_item) !== 0 ? _item : parseFloat(_item);\n    });\n  } else {\n    data.dataUnit[key] = data.data[key].toString().replace(/[^a-z|%]/g, '');\n    data.dataCount[key] = data.data[key].toString().replace(/[^+|=|-]/g, '');\n    var d = parseFloat(data.data[key].toString().replace(/[a-z|%|=]/g, ''));\n    data.data[key] = !d && d !== 0 ? data.data[key] : d;\n  }\n\n  return data;\n};\n\np.setDefaultData = function () {\n  var _this = this;\n\n  this.propsData.data = {};\n  this.propsData.dataType = {};\n  this.propsData.dataUnit = {};\n  this.propsData.dataCount = {};\n  this.propsData.dataSplitStr = {};\n  Object.keys(this.vars).forEach(function (_key) {\n    if (_key in _plugin) {\n      _this.propsData.data[_key] = new _plugin[_key](_this.target, _this.vars[_key]);\n      return;\n    }\n\n    var key = getGsapType(_key);\n\n    var _data = _this.getTweenData(key, _this.vars[_key]);\n\n    _this.propsData.data[key] = _data.data[key];\n    _this.propsData.dataType[key] = _data.dataType[key];\n    _this.propsData.dataUnit[key] = _data.dataUnit[key];\n    _this.propsData.dataCount[key] = _data.dataCount[key];\n\n    if (_data.dataSplitStr[key]) {\n      _this.propsData.dataSplitStr[key] = _data.dataSplitStr[key];\n    }\n  });\n};\n\np.convertToMarksArray = function (computedStyle, unit, key, data, i) {\n  var startUnit = data.toString().replace(/[^a-z|%]/g, '');\n  var endUnit = unit[i];\n\n  if (startUnit === endUnit) {\n    return parseFloat(data);\n  } else if (!parseFloat(data) && parseFloat(data) !== 0) {\n    return data;\n  }\n\n  return startConvertToEndUnit(this.target, computedStyle, key, data, startUnit, endUnit, null, key === 'transformOrigin' && !i);\n};\n\np.getAnimStart = function (computedStyle, tween, isSvg) {\n  var _this2 = this;\n\n  var style = {};\n  var tweenStyle = tween.style || {};\n  var transform = void 0;\n  Object.keys(this.propsData.data).forEach(function (key) {\n    var cssName = isConvert(key);\n    var startData = tweenStyle[cssName] || computedStyle[cssName];\n    var fixed = computedStyle.position === 'fixed';\n\n    if (!startData || startData === 'none' || startData === 'auto') {\n      startData = '';\n    }\n\n    var endUnit = void 0;\n    var startUnit = void 0;\n\n    if (key in _plugin) {\n      if (key === 'bezier') {\n        _this2.transform = checkStyleName('transform');\n        startData = computedStyle[isSvg ? 'transformSVG' : _this2.transform];\n        transform = transform || (tweenStyle.transform ? _extends({}, tweenStyle.transform) : style.transform || getTransform(startData));\n        style.transform = transform;\n      }\n\n      _this2.propsData.data[key].getAnimStart(computedStyle, isSvg);\n    } else if (cssName === 'transform') {\n      _this2.transform = checkStyleName('transform');\n      startData = computedStyle[isSvg ? 'transformSVG' : _this2.transform];\n      endUnit = _this2.propsData.dataUnit[key];\n      transform = transform || (tweenStyle.transform ? _extends({}, tweenStyle.transform) : style.transform || getTransform(startData));\n      var unitReg = /%|vw|vh|em|rem/i;\n\n      if (endUnit && endUnit.match(unitReg)) {\n        transform[key] = transform[key] && transform[key].toString().match(unitReg) ? parseFloat(transform[key]) : startConvertToEndUnit(_this2.target, computedStyle, key, transform[key], null, endUnit);\n      }\n\n      style.transform = transform;\n    } else if (cssName === 'filter') {\n      if (tweenStyle[cssName]) {\n        startData = tweenStyle[cssName];\n      } else {\n        _this2.filterName = checkStyleName('filter') || 'filter';\n        startData = computedStyle[_this2.filterName];\n        _this2.filterObject = _extends({}, _this2.filterObject, splitFilterToObject(startData));\n        startData = _this2.filterObject[key] || 0;\n      }\n\n      startUnit = startData.toString().replace(/[^a-z|%]/g, '');\n      endUnit = _this2.propsData.dataUnit[key];\n\n      if (endUnit !== startUnit) {\n        startData = startConvertToEndUnit(_this2.target, computedStyle, cssName, parseFloat(startData), startUnit, endUnit, fixed);\n      }\n\n      style[key] = parseFloat(startData);\n    } else if (key.match(/color|fill/i) || key === 'stroke') {\n      startData = !startData && key === 'stroke' ? 'rgba(255, 255, 255, 0)' : startData;\n      style[cssName] = parseColor(startData);\n    } else if (key.match(/shadow/i)) {\n      startData = parseShadow(startData);\n      endUnit = _this2.propsData.dataUnit[key];\n      startData = startData.map(_this2.convertToMarksArray.bind(_this2, computedStyle, endUnit, key));\n      style[cssName] = startData;\n    } else if (Array.isArray(_this2.propsData.data[key])) {\n      startData = startData.split(/[\\s|,]/).filter(function (c) {\n        return c || c === 0;\n      });\n      endUnit = _this2.propsData.dataUnit[key];\n      startData = startData.map(_this2.convertToMarksArray.bind(_this2, computedStyle, endUnit, key));\n      style[cssName] = startData;\n    } else {\n      // 计算单位\n      endUnit = _this2.propsData.dataUnit[cssName];\n      startUnit = startData.toString().replace(/[^a-z|%]/g, '');\n\n      if (endUnit !== startUnit) {\n        startData = startConvertToEndUnit(_this2.target, computedStyle, cssName, parseFloat(startData), startUnit, endUnit, fixed);\n      }\n\n      style[cssName] = parseFloat(startData || 0);\n    }\n  });\n  this.start = style;\n  return style;\n};\n\np.setArrayRatio = function (ratio, start, vars, unit, type) {\n  if (type === 'color' && start.length === 4 && vars.length === 3) {\n    vars[3] = 1;\n  }\n\n  var startInset = start.indexOf('inset') >= 0;\n  var endInset = vars.indexOf('inset') >= 0;\n\n  if (startInset && !endInset || endInset && !startInset) {\n    throw console.error('Error: \"box-shadow\" inset have to exist');\n  }\n\n  var length = endInset ? 9 : 8;\n\n  if (start.length === length && vars.length === length - 1) {\n    vars.splice(3, 0, 0);\n    unit.splice(3, 0, '');\n  } else if (vars.length === length && start.length === length - 1) {\n    start.splice(3, 0, 0);\n  }\n\n  var _vars = vars.map(function (endData, i) {\n    var startIsAlpha = type === 'color' && i === 3 && !start[i] ? 1 : 0;\n    var startData = typeof start[i] === 'number' ? start[i] : startIsAlpha;\n\n    if (typeof endData === 'string') {\n      return endData;\n    }\n\n    return (endData - startData) * ratio + startData + (unit[i] || 0);\n  });\n\n  if (type === 'color') {\n    return getColor(_vars);\n  } else if (type === 'shadow') {\n    var l = _vars.length === length ? 4 : 3;\n\n    var s = _vars.slice(0, l).map(function (item) {\n      if (typeof item === 'number') {\n        return item + 'px';\n      }\n\n      return item;\n    });\n\n    var c = _vars.slice(l, endInset ? _vars.length - 1 : _vars.length);\n\n    var color = getColor(c);\n    return (s.join(' ') + ' ' + color + ' ' + (endInset ? 'inset' : '')).trim();\n  }\n\n  return _vars;\n};\n\np.setRatio = function (ratio, tween, computedStyle) {\n  var _this3 = this;\n\n  tween.style = tween.style || {};\n\n  if (this.start.transform) {\n    tween.style.transform = tween.style.transform || _extends({}, this.start.transform);\n  }\n\n  var style = this.target.style;\n  Object.keys(this.propsData.data).forEach(function (key) {\n    var _isTransform = isTransform(key) === 'transform';\n\n    var startVars = _isTransform ? _this3.start.transform[key] : _this3.start[key];\n    var endVars = _this3.propsData.data[key];\n    var unit = _this3.propsData.dataUnit[key];\n    var count = _this3.propsData.dataCount[key];\n\n    if (key in _plugin) {\n      _this3.propsData.data[key].setRatio(ratio, tween, computedStyle);\n\n      if (key === 'bezier') {\n        style[_this3.transform] = getTransformValue(tween.style.transform);\n      } else {\n        Object.keys(tween.style).forEach(function (css) {\n          style[css] = tween.style[css];\n        });\n      }\n\n      return;\n    } else if (_isTransform) {\n      if (unit && unit.match(/%|vw|vh|em|rem/i)) {\n        startVars = parseFloat(_this3.start.transform[key]);\n\n        if (count.charAt(1) === '=') {\n          tween.style.transform[key] = startVars + endVars * ratio + unit;\n        } else {\n          tween.style.transform[key] = (endVars - startVars) * ratio + startVars + unit;\n        }\n      } else if (key === 'scale') {\n        var xStart = _this3.start.transform.scaleX;\n        var yStart = _this3.start.transform.scaleY;\n\n        if (count.charAt(1) === '=') {\n          tween.style.transform.scaleX = xStart + endVars * ratio;\n          tween.style.transform.scaleY = yStart + endVars * ratio;\n        } else {\n          tween.style.transform.scaleX = (endVars - xStart) * ratio + xStart;\n          tween.style.transform.scaleY = (endVars - yStart) * ratio + yStart;\n        }\n      } else if (count.charAt(1) === '=') {\n        tween.style.transform[key] = startVars + endVars * ratio;\n      } else {\n        tween.style.transform[key] = (endVars - startVars) * ratio + startVars;\n      }\n\n      style[_this3.transform] = getTransformValue(tween.style.transform);\n\n      if (computedStyle) {\n        computedStyle.transformSVG = createMatrix(style[_this3.transform]).toString();\n      }\n\n      return;\n    } else if (Array.isArray(endVars)) {\n      var _type = _this3.propsData.dataType[key];\n      tween.style[key] = _this3.setArrayRatio(ratio, startVars, endVars, unit, _type);\n\n      if (_type === 'string') {\n        tween.style[key] = tween.style[key].join(_this3.propsData.dataSplitStr[key]);\n      }\n    } else {\n      var styleUnit = stylesToCss(key, 0);\n      styleUnit = typeof styleUnit === 'number' ? '' : styleUnit.replace(/[^a-z|%]/g, '');\n      unit = unit || (cssList.filter.indexOf(key) >= 0 ? '' : styleUnit);\n\n      if (typeof endVars === 'string') {\n        tween.style[key] = endVars;\n      } else if (count.charAt(1) === '=') {\n        tween.style[key] = startVars + endVars * ratio + unit;\n      } else {\n        var value = (endVars - startVars) * ratio + startVars;\n        tween.style[key] = unit ? '' + value + unit : value;\n      }\n    }\n\n    if (cssList.filter.indexOf(key) >= 0) {\n      if (!_this3.filterObject) {\n        return;\n      }\n\n      _this3.filterObject[key] = tween.style[key];\n      var filterStyle = '';\n      Object.keys(_this3.filterObject).forEach(function (filterKey) {\n        filterStyle += ' ' + filterKey + '(' + _this3.filterObject[filterKey] + ')';\n      });\n      style[_this3.filterName] = filterStyle.trim();\n      return;\n    }\n\n    style[key] = tween.style[key];\n  });\n};\n\nexport default StylePlugin;","map":{"version":3,"sources":["/Users/manhsy/Developer/manhsy-portfolio/node_modules/rc-tween-one/es/plugin/StylePlugin.js"],"names":["_extends","cssList","checkStyleName","getGsapType","parseShadow","getColor","parseColor","isTransform","isConvert","splitFilterToObject","getTransform","stylesToCss","createMatrix","startConvertToEndUnit","getTransformValue","styleValueToArray","_plugin","StylePlugin","target","vars","type","propsData","setDefaultData","prototype","name","p","getTweenData","key","$vars","data","dataType","dataUnit","dataCount","dataSplitStr","toString","split","map","c","join","match","length","replace","Array","isArray","_item","parseFloat","d","_this","Object","keys","forEach","_key","_data","convertToMarksArray","computedStyle","unit","i","startUnit","endUnit","getAnimStart","tween","isSvg","_this2","style","tweenStyle","transform","cssName","startData","fixed","position","unitReg","filterName","filterObject","bind","filter","start","setArrayRatio","ratio","startInset","indexOf","endInset","console","error","splice","_vars","endData","startIsAlpha","l","s","slice","item","color","trim","setRatio","_this3","_isTransform","startVars","endVars","count","css","charAt","xStart","scaleX","yStart","scaleY","transformSVG","_type","styleUnit","value","filterStyle","filterKey"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\n/* eslint-disable func-names, no-console */\nimport { cssList, checkStyleName, getGsapType, parseShadow, getColor, parseColor, isTransform, isConvert, splitFilterToObject, getTransform, stylesToCss, createMatrix } from 'style-utils';\nimport { startConvertToEndUnit, getTransformValue, styleValueToArray } from '../util.js';\nimport _plugin from '../plugins';\n\nvar StylePlugin = function StylePlugin(target, vars, type) {\n  this.target = target;\n  this.vars = vars;\n  this.type = type;\n  this.propsData = {};\n  this.setDefaultData();\n};\nStylePlugin.prototype = {\n  name: 'style'\n};\nvar p = StylePlugin.prototype;\np.getTweenData = function (key, $vars) {\n  var data = {\n    data: {},\n    dataType: {},\n    dataUnit: {},\n    dataCount: {},\n    dataSplitStr: {}\n  };\n  var vars = $vars;\n  if (styleValueToArray[key]) {\n    vars = vars.toString().split(' ');\n    vars = vars.map(function (c) {\n      return typeof $vars === 'number' ? c + 'px' : c;\n    });\n    vars[1] = vars[1] || vars[0];\n    vars[2] = vars[2] || vars[0];\n    vars[3] = vars[3] || vars[1] || vars[0];\n    vars = vars.join(' ');\n  }\n  if (key.match(/colo|fill|storker/i)) {\n    data.data[key] = parseColor(vars);\n    data.dataType[key] = 'color';\n  } else if (key === 'strokeDasharray') {\n    data.data[key] = vars.split(',');\n    data.dataType[key] = 'strokeDasharray';\n  } else if (key.match(/shadow/i)) {\n    data.data[key] = parseShadow(vars);\n    data.dataType[key] = 'shadow';\n  } else if (typeof vars === 'string' && vars.split(/[\\s|,]/).length > 1) {\n    data.data[key] = vars.split(/[\\s|,]/);\n    data.dataSplitStr[key] = vars.replace(/[^\\s|,]/g, '').replace(/\\s+/g, ' ');\n    data.dataType[key] = 'string';\n  } else {\n    data.data[key] = vars;\n    data.dataType[key] = 'other';\n  }\n  if (Array.isArray(data.data[key])) {\n    data.dataUnit[key] = data.data[key].map(function (_item) {\n      return _item.toString().replace(/[^a-z|%]/g, '');\n    });\n    data.dataCount[key] = data.data[key].map(function (_item) {\n      return _item.toString().replace(/[^+|=|-]/g, '');\n    });\n\n    data.data[key] = data.data[key].map(function (_item) {\n      return !parseFloat(_item) && parseFloat(_item) !== 0 ? _item : parseFloat(_item);\n    });\n  } else {\n    data.dataUnit[key] = data.data[key].toString().replace(/[^a-z|%]/g, '');\n    data.dataCount[key] = data.data[key].toString().replace(/[^+|=|-]/g, '');\n    var d = parseFloat(data.data[key].toString().replace(/[a-z|%|=]/g, ''));\n    data.data[key] = !d && d !== 0 ? data.data[key] : d;\n  }\n  return data;\n};\np.setDefaultData = function () {\n  var _this = this;\n\n  this.propsData.data = {};\n  this.propsData.dataType = {};\n  this.propsData.dataUnit = {};\n  this.propsData.dataCount = {};\n  this.propsData.dataSplitStr = {};\n  Object.keys(this.vars).forEach(function (_key) {\n    if (_key in _plugin) {\n      _this.propsData.data[_key] = new _plugin[_key](_this.target, _this.vars[_key]);\n      return;\n    }\n    var key = getGsapType(_key);\n    var _data = _this.getTweenData(key, _this.vars[_key]);\n    _this.propsData.data[key] = _data.data[key];\n    _this.propsData.dataType[key] = _data.dataType[key];\n    _this.propsData.dataUnit[key] = _data.dataUnit[key];\n    _this.propsData.dataCount[key] = _data.dataCount[key];\n    if (_data.dataSplitStr[key]) {\n      _this.propsData.dataSplitStr[key] = _data.dataSplitStr[key];\n    }\n  });\n};\np.convertToMarksArray = function (computedStyle, unit, key, data, i) {\n  var startUnit = data.toString().replace(/[^a-z|%]/g, '');\n  var endUnit = unit[i];\n  if (startUnit === endUnit) {\n    return parseFloat(data);\n  } else if (!parseFloat(data) && parseFloat(data) !== 0) {\n    return data;\n  }\n  return startConvertToEndUnit(this.target, computedStyle, key, data, startUnit, endUnit, null, key === 'transformOrigin' && !i);\n};\np.getAnimStart = function (computedStyle, tween, isSvg) {\n  var _this2 = this;\n\n  var style = {};\n  var tweenStyle = tween.style || {};\n  var transform = void 0;\n  Object.keys(this.propsData.data).forEach(function (key) {\n    var cssName = isConvert(key);\n    var startData = tweenStyle[cssName] || computedStyle[cssName];\n    var fixed = computedStyle.position === 'fixed';\n    if (!startData || startData === 'none' || startData === 'auto') {\n      startData = '';\n    }\n    var endUnit = void 0;\n    var startUnit = void 0;\n    if (key in _plugin) {\n      if (key === 'bezier') {\n        _this2.transform = checkStyleName('transform');\n        startData = computedStyle[isSvg ? 'transformSVG' : _this2.transform];\n        transform = transform || (tweenStyle.transform ? _extends({}, tweenStyle.transform) : style.transform || getTransform(startData));\n        style.transform = transform;\n      }\n      _this2.propsData.data[key].getAnimStart(computedStyle, isSvg);\n    } else if (cssName === 'transform') {\n      _this2.transform = checkStyleName('transform');\n      startData = computedStyle[isSvg ? 'transformSVG' : _this2.transform];\n      endUnit = _this2.propsData.dataUnit[key];\n      transform = transform || (tweenStyle.transform ? _extends({}, tweenStyle.transform) : style.transform || getTransform(startData));\n      var unitReg = /%|vw|vh|em|rem/i;\n      if (endUnit && endUnit.match(unitReg)) {\n        transform[key] = transform[key] && transform[key].toString().match(unitReg) ? parseFloat(transform[key]) : startConvertToEndUnit(_this2.target, computedStyle, key, transform[key], null, endUnit);\n      }\n      style.transform = transform;\n    } else if (cssName === 'filter') {\n      if (tweenStyle[cssName]) {\n        startData = tweenStyle[cssName];\n      } else {\n        _this2.filterName = checkStyleName('filter') || 'filter';\n        startData = computedStyle[_this2.filterName];\n        _this2.filterObject = _extends({}, _this2.filterObject, splitFilterToObject(startData));\n        startData = _this2.filterObject[key] || 0;\n      }\n      startUnit = startData.toString().replace(/[^a-z|%]/g, '');\n      endUnit = _this2.propsData.dataUnit[key];\n      if (endUnit !== startUnit) {\n        startData = startConvertToEndUnit(_this2.target, computedStyle, cssName, parseFloat(startData), startUnit, endUnit, fixed);\n      }\n      style[key] = parseFloat(startData);\n    } else if (key.match(/color|fill/i) || key === 'stroke') {\n      startData = !startData && key === 'stroke' ? 'rgba(255, 255, 255, 0)' : startData;\n      style[cssName] = parseColor(startData);\n    } else if (key.match(/shadow/i)) {\n      startData = parseShadow(startData);\n      endUnit = _this2.propsData.dataUnit[key];\n      startData = startData.map(_this2.convertToMarksArray.bind(_this2, computedStyle, endUnit, key));\n      style[cssName] = startData;\n    } else if (Array.isArray(_this2.propsData.data[key])) {\n      startData = startData.split(/[\\s|,]/).filter(function (c) {\n        return c || c === 0;\n      });\n      endUnit = _this2.propsData.dataUnit[key];\n      startData = startData.map(_this2.convertToMarksArray.bind(_this2, computedStyle, endUnit, key));\n      style[cssName] = startData;\n    } else {\n      // 计算单位\n      endUnit = _this2.propsData.dataUnit[cssName];\n      startUnit = startData.toString().replace(/[^a-z|%]/g, '');\n      if (endUnit !== startUnit) {\n        startData = startConvertToEndUnit(_this2.target, computedStyle, cssName, parseFloat(startData), startUnit, endUnit, fixed);\n      }\n      style[cssName] = parseFloat(startData || 0);\n    }\n  });\n  this.start = style;\n  return style;\n};\np.setArrayRatio = function (ratio, start, vars, unit, type) {\n  if (type === 'color' && start.length === 4 && vars.length === 3) {\n    vars[3] = 1;\n  }\n  var startInset = start.indexOf('inset') >= 0;\n  var endInset = vars.indexOf('inset') >= 0;\n  if (startInset && !endInset || endInset && !startInset) {\n    throw console.error('Error: \"box-shadow\" inset have to exist');\n  }\n  var length = endInset ? 9 : 8;\n  if (start.length === length && vars.length === length - 1) {\n    vars.splice(3, 0, 0);\n    unit.splice(3, 0, '');\n  } else if (vars.length === length && start.length === length - 1) {\n    start.splice(3, 0, 0);\n  }\n  var _vars = vars.map(function (endData, i) {\n    var startIsAlpha = type === 'color' && i === 3 && !start[i] ? 1 : 0;\n    var startData = typeof start[i] === 'number' ? start[i] : startIsAlpha;\n    if (typeof endData === 'string') {\n      return endData;\n    }\n    return (endData - startData) * ratio + startData + (unit[i] || 0);\n  });\n  if (type === 'color') {\n    return getColor(_vars);\n  } else if (type === 'shadow') {\n    var l = _vars.length === length ? 4 : 3;\n    var s = _vars.slice(0, l).map(function (item) {\n      if (typeof item === 'number') {\n        return item + 'px';\n      }\n      return item;\n    });\n    var c = _vars.slice(l, endInset ? _vars.length - 1 : _vars.length);\n    var color = getColor(c);\n    return (s.join(' ') + ' ' + color + ' ' + (endInset ? 'inset' : '')).trim();\n  }\n  return _vars;\n};\n\np.setRatio = function (ratio, tween, computedStyle) {\n  var _this3 = this;\n\n  tween.style = tween.style || {};\n  if (this.start.transform) {\n    tween.style.transform = tween.style.transform || _extends({}, this.start.transform);\n  }\n  var style = this.target.style;\n  Object.keys(this.propsData.data).forEach(function (key) {\n    var _isTransform = isTransform(key) === 'transform';\n    var startVars = _isTransform ? _this3.start.transform[key] : _this3.start[key];\n    var endVars = _this3.propsData.data[key];\n    var unit = _this3.propsData.dataUnit[key];\n    var count = _this3.propsData.dataCount[key];\n    if (key in _plugin) {\n      _this3.propsData.data[key].setRatio(ratio, tween, computedStyle);\n      if (key === 'bezier') {\n        style[_this3.transform] = getTransformValue(tween.style.transform);\n      } else {\n        Object.keys(tween.style).forEach(function (css) {\n          style[css] = tween.style[css];\n        });\n      }\n      return;\n    } else if (_isTransform) {\n      if (unit && unit.match(/%|vw|vh|em|rem/i)) {\n        startVars = parseFloat(_this3.start.transform[key]);\n        if (count.charAt(1) === '=') {\n          tween.style.transform[key] = startVars + endVars * ratio + unit;\n        } else {\n          tween.style.transform[key] = (endVars - startVars) * ratio + startVars + unit;\n        }\n      } else if (key === 'scale') {\n        var xStart = _this3.start.transform.scaleX;\n        var yStart = _this3.start.transform.scaleY;\n        if (count.charAt(1) === '=') {\n          tween.style.transform.scaleX = xStart + endVars * ratio;\n          tween.style.transform.scaleY = yStart + endVars * ratio;\n        } else {\n          tween.style.transform.scaleX = (endVars - xStart) * ratio + xStart;\n          tween.style.transform.scaleY = (endVars - yStart) * ratio + yStart;\n        }\n      } else if (count.charAt(1) === '=') {\n        tween.style.transform[key] = startVars + endVars * ratio;\n      } else {\n        tween.style.transform[key] = (endVars - startVars) * ratio + startVars;\n      }\n      style[_this3.transform] = getTransformValue(tween.style.transform);\n      if (computedStyle) {\n        computedStyle.transformSVG = createMatrix(style[_this3.transform]).toString();\n      }\n      return;\n    } else if (Array.isArray(endVars)) {\n      var _type = _this3.propsData.dataType[key];\n      tween.style[key] = _this3.setArrayRatio(ratio, startVars, endVars, unit, _type);\n      if (_type === 'string') {\n        tween.style[key] = tween.style[key].join(_this3.propsData.dataSplitStr[key]);\n      }\n    } else {\n      var styleUnit = stylesToCss(key, 0);\n      styleUnit = typeof styleUnit === 'number' ? '' : styleUnit.replace(/[^a-z|%]/g, '');\n      unit = unit || (cssList.filter.indexOf(key) >= 0 ? '' : styleUnit);\n      if (typeof endVars === 'string') {\n        tween.style[key] = endVars;\n      } else if (count.charAt(1) === '=') {\n        tween.style[key] = startVars + endVars * ratio + unit;\n      } else {\n        var value = (endVars - startVars) * ratio + startVars;\n        tween.style[key] = unit ? '' + value + unit : value;\n      }\n    }\n    if (cssList.filter.indexOf(key) >= 0) {\n      if (!_this3.filterObject) {\n        return;\n      }\n      _this3.filterObject[key] = tween.style[key];\n      var filterStyle = '';\n      Object.keys(_this3.filterObject).forEach(function (filterKey) {\n        filterStyle += ' ' + filterKey + '(' + _this3.filterObject[filterKey] + ')';\n      });\n      style[_this3.filterName] = filterStyle.trim();\n      return;\n    }\n    style[key] = tween.style[key];\n  });\n};\nexport default StylePlugin;"]},"metadata":{},"sourceType":"module"}