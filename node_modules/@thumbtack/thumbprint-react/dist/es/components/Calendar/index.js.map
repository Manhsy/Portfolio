{"version":3,"file":"index.js","sources":["../../../../components/Calendar/index.tsx"],"sourcesContent":["import React from 'react';\nimport DayPicker, {\n    DateUtils,\n    Modifiers,\n    Modifier,\n    BeforeModifier,\n    BeforeAfterModifier,\n    AfterModifier,\n} from 'react-day-picker';\n\nimport get from 'lodash/get';\nimport map from 'lodash/map';\nimport findIndex from 'lodash/findIndex';\nimport some from 'lodash/some';\nimport castArray from 'lodash/castArray';\n\nimport parse from 'date-fns/parse';\nimport isAfter from 'date-fns/is_after';\nimport isBefore from 'date-fns/is_before';\nimport endOfDay from 'date-fns/end_of_day';\nimport startOfDay from 'date-fns/start_of_day';\n\nimport styles from './index.module.scss';\n\nexport type DateIsh = Date | string | number;\n\nfunction throwError(message: string): void {\n    throw new Error(`TUI DatePicker: ${message}`);\n}\n\nexport function normaliseValue(value: PropTypes['value']): Date[] {\n    if (value === null) {\n        return [];\n    }\n\n    const valueArr: DateIsh[] = castArray<DateIsh>(value);\n\n    return map<DateIsh, Date>(valueArr, d => parse(d));\n}\n\n// Returns true any of the given `dates` fall on a day before the day of `cutoff`.\nexport function hasAnyPastDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isBefore(endOfDay(date), cutoff));\n}\n\n// Returns true any of the given `dates` fall on a day after the day of `cutoff`.\nexport function hasAnyFutureDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isAfter(startOfDay(date), cutoff));\n}\n\nfunction isBeforeModifier(\n    modifier: Modifier | null,\n): modifier is BeforeModifier | BeforeAfterModifier {\n    return !!modifier && 'before' in modifier;\n}\nfunction isAfterModifier(\n    modifier: Modifier | null,\n): modifier is AfterModifier | BeforeAfterModifier {\n    return !!modifier && 'after' in modifier;\n}\n\nexport function validateProps(props: PropTypes): void {\n    const days = normaliseValue(props.value);\n\n    if (!props.allowMultiSelection && days.length > 1) {\n        throwError('`allowMultiSelection` is `false` but multiple dates were provided');\n    }\n\n    if (isBeforeModifier(props.disabledDays) && hasAnyPastDays(days, props.disabledDays.before)) {\n        throwError(\n            `Days before ${props.disabledDays.before} are disabled but one or more provided days fall before that.`,\n        );\n    }\n\n    if (isAfterModifier(props.disabledDays) && hasAnyFutureDays(days, props.disabledDays.after)) {\n        throwError(\n            `Days after ${props.disabledDays.after} are disabled but one or more provided days fall after that.`,\n        );\n    }\n}\n\ninterface PropTypes {\n    /**\n     * One or more dates to show as selected in the initial UI. Each \"date\" can be a JS Date object\n     * or a string representing a date, or a numeric UNIX timestamp, and either a single object or\n     * an array of such objects can be provided.\n     */\n    value?: DateIsh | DateIsh[] | null;\n    /**\n     * Date object representing the month that is currently displayed by the calendar. If omitted\n     * it will default to the first date in the `value` prop. You should update it in response to\n     * the `onMonthChange` prop.\n     */\n    month?: Date;\n    /**\n     * Callback that is triggered when th user selects a date. The function receives an array of\n     * a JavaScript Date objects for each of the currently selected dates.\n     */\n    onChange: (selectedDates: Date[]) => void;\n    /**\n     * Callback that is triggered when the user navigates to a different month using the navigation\n     * buttons or keyboard. The function receives a single JavaScript `Date` object indicating\n     * the new on-screen month.\n     */\n    onMonthChange: (selectedMonth: Date) => void;\n    /**\n     * Boolean that determines whether or not the user is allowed to select more than one date at\n     * a time. Defaults to `false`.\n     */\n    allowMultiSelection?: boolean;\n    /**\n     * A react-day-picker modifier for greater control over disabled days. Past selection is\n     * disabled by default.\n     * http://react-day-picker.js.org/docs/modifiers.html\n     */\n    disabledDays?: Modifier | null;\n    /**\n     * A Date object representing the last allowed month. Users wonâ€™t be able to navigate or\n     * interact with the days after it.\n     */\n    lastMonth?: Date;\n    /**\n     * Applies a blue dot indicator below the numeric day in the calendar's day cell if the\n     * function returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeDotIndicator?: (date: Date) => boolean;\n    /**\n     * Applies a strikeout treatment on the numeric day in the calendar's day cell if the function\n     * returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeStrikeout?: (date: Date) => boolean;\n}\n\n/**\n * Thin wrapper around `react-day-picker` that renders a calendar.\n */\nconst Calendar = ({\n    value = [],\n    onChange,\n    onMonthChange,\n    disabledDays = { before: new Date() },\n    month,\n    lastMonth,\n    allowMultiSelection = false,\n    daysThemeDotIndicator,\n    daysThemeStrikeout,\n}: PropTypes): JSX.Element => {\n    validateProps({\n        value,\n        onChange,\n        disabledDays,\n        month,\n        lastMonth,\n        allowMultiSelection,\n        onMonthChange,\n        daysThemeDotIndicator,\n        daysThemeStrikeout,\n    });\n\n    const selectedDays = normaliseValue(value);\n\n    const modifiers: Partial<Modifiers> = {};\n\n    if (typeof daysThemeDotIndicator === 'function') {\n        modifiers['theme-dot'] = daysThemeDotIndicator;\n    }\n\n    if (typeof daysThemeStrikeout === 'function') {\n        modifiers['theme-strikeout'] = daysThemeStrikeout;\n    }\n\n    return (\n        <div className={styles.root}>\n            <DayPicker\n                disabledDays={disabledDays || undefined}\n                fromMonth={get(disabledDays, 'before', null)}\n                toMonth={lastMonth}\n                month={month || selectedDays[0]}\n                initialMonth={month || selectedDays[0]}\n                selectedDays={selectedDays}\n                onMonthChange={onMonthChange}\n                modifiers={modifiers}\n                onDayClick={(day, { selected, disabled }): void => {\n                    if (disabled) {\n                        return;\n                    }\n\n                    let newSelectedDays = normaliseValue(value);\n\n                    if (allowMultiSelection) {\n                        if (selected) {\n                            const selectedIndex = findIndex(newSelectedDays, selectedDay =>\n                                DateUtils.isSameDay(selectedDay, day),\n                            );\n                            newSelectedDays.splice(selectedIndex, 1);\n                        } else {\n                            newSelectedDays.push(day);\n                        }\n                    } else {\n                        newSelectedDays = [day];\n                    }\n\n                    onChange(map(newSelectedDays, startOfDay));\n                }}\n            />\n        </div>\n    );\n};\n\nexport default Calendar;\n"],"names":["throwError","message","Error","normaliseValue","value","valueArr","castArray","map","d","parse","hasAnyPastDays","dates","cutoff","Date","some","date","isBefore","endOfDay","hasAnyFutureDays","isAfter","startOfDay","isBeforeModifier","modifier","isAfterModifier","validateProps","props","days","allowMultiSelection","length","disabledDays","before","after","Calendar","onChange","onMonthChange","month","lastMonth","daysThemeDotIndicator","daysThemeStrikeout","selectedDays","modifiers","styles","root","undefined","get","day","selected","disabled","newSelectedDays","selectedIndex","findIndex","selectedDay","DateUtils","isSameDay","splice","push"],"mappings":"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"}